--- RED RAG Overall Report V2 ---

## 1. DVWA + ModSecurity PL1 Extended Evaluation Summary

--- RED RAG Extended Evaluation Summary (DVWA PL1) ---

BASELINE Mode:
  Total Payloads: 99
  Passed WAF: 35 (35.35%)
  Blocked by WAF: 64
  Errors: 0

RAG_V2 Mode:
  Total Payloads: 99
  Passed WAF: 42 (42.42%)
  Blocked by WAF: 57
  Errors: 0


## 2. Multi-WAF Extended Evaluation Summary

--- RED RAG Multi-WAF Extended Evaluation Summary ---

V2 Mode for modsec_pl1_dvwa_rag:
  Total Payloads: 50
  Passed WAF: 23 (46.00%)
  Blocked by WAF: 27
  Errors: 0

V2 Mode for modsec_pl4_dvwa_rag:
  Total Payloads: 50
  Passed WAF: 24 (48.00%)
  Blocked by WAF: 26
  Errors: 0

V2 Mode for coraza_pl1_dvwa_rag:
  Total Payloads: 50
  Passed WAF: 24 (48.00%)
  Blocked by WAF: 26
  Errors: 0


## 3. RAG Document Impact Analysis Summary

--- RAG Document Impact Summary ---
Analyzed 100 RAG-mode attacks.
Identified impact for 15 unique RAG documents.

Top 10 Documents by Usage Count:
- pattern_XSS_XSS_Script_context_escape_568 (Kind: payload_pattern, Type: XSS): Used=34, Passed=9, Rate=26.47%
- strategy_XSS_script_tag_xss_3 (Kind: attack_strategy, Type: XSS): Used=34, Passed=9, Rate=26.47%
- pattern_XSS_XSS_Reflected__Generated__1 (Kind: payload_pattern, Type: XSS): Used=34, Passed=9, Rate=26.47%
- pattern_XSS_obf_double_url_encode_obf_whitespace_url_obf_case__3 (Kind: payload_pattern, Type: XSS): Used=34, Passed=9, Rate=26.47%
- pattern_XSS_obf_double_url_encode_obf_case_random_4 (Kind: payload_pattern, Type: XSS): Used=34, Passed=9, Rate=26.47%
- strategy_SQLI_union_based_sqli_16 (Kind: attack_strategy, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_SQLI_Union_Boolean_SQLI__manual_refine__adv_obf_full_by_72 (Kind: payload_pattern, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_SQLI_Union_Boolean_SQLI__manual_refine__full_bypass_107 (Kind: payload_pattern, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_SQLI_Union_Boolean_SQLI__manual_refine__313 (Kind: payload_pattern, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_SQLI_Union_Boolean_SQLI__manual_refine__adv_obf_543 (Kind: payload_pattern, Type: SQLI): Used=33, Passed=21, Rate=63.64%

Top 10 Documents by Success Rate (used >= 5 times):
- strategy_SQLI_union_based_sqli_16 (Kind: attack_strategy, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_SQLI_Union_Boolean_SQLI__manual_refine__adv_obf_full_by_72 (Kind: payload_pattern, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_SQLI_Union_Boolean_SQLI__manual_refine__full_bypass_107 (Kind: payload_pattern, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_SQLI_Union_Boolean_SQLI__manual_refine__313 (Kind: payload_pattern, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_SQLI_Union_Boolean_SQLI__manual_refine__adv_obf_543 (Kind: payload_pattern, Type: SQLI): Used=33, Passed=21, Rate=63.64%
- pattern_OS_INJECTION_OS_Command_ls_572 (Kind: payload_pattern, Type: OS_INJECTION): Used=33, Passed=16, Rate=48.48%
- pattern_OS_INJECTION_Command_Injection_2 (Kind: payload_pattern, Type: OS_INJECTION): Used=33, Passed=16, Rate=48.48%
- pattern_OS_INJECTION_Command_Injection_adv_obf_full_bypass_86 (Kind: payload_pattern, Type: OS_INJECTION): Used=33, Passed=16, Rate=48.48%
- pattern_OS_INJECTION_Command_Injection_full_bypass_144 (Kind: payload_pattern, Type: OS_INJECTION): Used=33, Passed=16, Rate=48.48%
- pattern_OS_INJECTION_Command_Injection_adv_obf_556 (Kind: payload_pattern, Type: OS_INJECTION): Used=33, Passed=16, Rate=48.48%


## 4. SFT/RL Dataset Candidates

Number of RAG-aware SFT/RL candidates generated: 46 samples in data/processed/red_phase2_rag_sft_candidates.jsonl


