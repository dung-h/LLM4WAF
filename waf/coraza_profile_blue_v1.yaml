
{
    order coraza_waf first
}

:80 {
    log {
        output stdout
        format json
    }

    coraza_waf {
        directives "Include /etc/coraza/coraza.conf"

        # --- BLUE Phase 3 OVERLAY ---
        # Custom rules generated by BLUE LLM (Placeholder)
        # Coraza rules are usually SecRule syntax compatible, but might need translation
        # from the YAML suggestion file. For now, we'll indicate an include.
        Include /etc/coraza/blue_coraza_suggestions.yaml
        # ----------------------------
    }

    handle_path /dvwa/* {
        reverse_proxy dvwa-app:80
    }

    handle_path /juice/* {
        reverse_proxy juice-shop-app:3000
    }

    handle {
        respond "Not Found. Try /dvwa or /juice" 404
    }
}
