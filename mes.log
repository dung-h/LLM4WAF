[2025-12-01 13:42:30] CMD="python scripts/create_phase2_eval_test_set.py" STATUS=OK OUTPUT="data/processed/red_v40_phase2_eval_test.jsonl"
[2025-12-01 13:49:04] CMD="python scripts/create_phase2_eval_test_set.py" STATUS=OK OUTPUT="data/processed/red_v40_phase2_eval_test.jsonl"
[12/01/2025 13:59:13] Starting Eval Gemma 2 Phase 2
`torch_dtype` is deprecated! Use `dtype` instead!
Loading base model: google/gemma-2-2b-it
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.32s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  6.45s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  7.63s/it]
Loading adapter: experiments/phase2_gemma2_2b_reasoning
Generating train split: 0 examples [00:00, ? examples/s]Generating train split: 100 examples [00:00, 2048.56 examples/s]
Generating payloads with batch size 32...
  0%|          | 0/4 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
 25%|██▌       | 1/4 [01:01<03:03, 61.16s/it] 50%|█████     | 2/4 [01:58<01:58, 59.03s/it] 75%|███████▌  | 3/4 [02:55<00:57, 57.81s/it]100%|██████████| 4/4 [03:47<00:00, 55.50s/it]100%|██████████| 4/4 [03:47<00:00, 56.75s/it]
Testing payloads against WAF...
[+] Logging into DVWA...
  0%|          | 0/100 [00:00<?, ?it/s] 10%|█         | 10/100 [00:00<00:00, 96.58it/s] 22%|██▏       | 22/100 [00:00<00:00, 104.09it/s] 33%|███▎      | 33/100 [00:00<00:00, 105.48it/s] 45%|████▌     | 45/100 [00:00<00:00, 109.15it/s] 56%|█████▌    | 56/100 [00:00<00:00, 106.55it/s] 67%|██████▋   | 67/100 [00:00<00:00, 104.20it/s] 79%|███████▉  | 79/100 [00:00<00:00, 106.77it/s] 90%|█████████ | 90/100 [00:00<00:00, 105.11it/s]100%|██████████| 100/100 [00:00<00:00, 104.84it/s]
[2025-12-01 14:07:00] CMD="python scripts/evaluate_model.py --adapter experiments/phase2_gemma2_2b_reasoning" STATUS=OK OUTPUT="eval_phase2_gemma.jsonl"

--- Summary ---
failed_waf_filter: 62 (62.00%)
reflected_no_exec: 24 (24.00%)
passed: 7 (7.00%)
blocked: 7 (7.00%)
Total Bypass: 7.00%
[12/01/2025 14:07:21] Starting Eval Phi 3 Phase 2
`torch_dtype` is deprecated! Use `dtype` instead!
Loading base model: microsoft/Phi-3-mini-4k-instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.50s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:23<00:00, 11.16s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:23<00:00, 11.66s/it]
Loading adapter: experiments/phase2_phi3_mini_reasoning
Generating payloads with batch size 32...
  0%|          | 0/4 [00:00<?, ?it/s]  0%|          | 0/4 [5:08:18<?, ?it/s]
[2025-12-01 19:19:03] CMD="python scripts/evaluate_model.py --adapter experiments/phase2_phi3_mini_reasoning" STATUS=FAIL OUTPUT="CUDA out of memory. Tried to allocate 188.00 MiB. GPU 0 has a total capacity of 8.00 GiB of which 0 bytes is free. Including non-PyTorch memory, this process has 17179869184.00 GiB memory in use. Of the allocated memory 14.11 GiB is allocated by PyTorch, and 4.06 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)"
Evaluation failed: CUDA out of memory. Tried to allocate 188.00 MiB. GPU 0 has a total capacity of 8.00 GiB of which 0 bytes is free. Including non-PyTorch memory, this process has 17179869184.00 GiB memory in use. Of the allocated memory 14.11 GiB is allocated by PyTorch, and 4.06 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[12/01/2025 19:19:40] Retry Eval Phi 3 Phase 2 (BS=8)
`torch_dtype` is deprecated! Use `dtype` instead!
Loading base model: microsoft/Phi-3-mini-4k-instruct
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [01:02<01:02, 62.11s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:30<00:00, 42.10s/it]Loading checkpoint shards: 100%|██████████| 2/2 [01:30<00:00, 45.10s/it]
Loading adapter: experiments/phase2_phi3_mini_reasoning
Generating payloads with batch size 8...
  0%|          | 0/13 [00:00<?, ?it/s]  8%|▊         | 1/13 [00:39<07:53, 39.45s/it] 15%|█▌        | 2/13 [01:14<06:42, 36.61s/it] 23%|██▎       | 3/13 [01:50<06:03, 36.36s/it] 31%|███       | 4/13 [02:24<05:19, 35.51s/it] 38%|███▊      | 5/13 [02:59<04:42, 35.29s/it] 46%|████▌     | 6/13 [03:35<04:10, 35.74s/it] 54%|█████▍    | 7/13 [04:10<03:31, 35.25s/it] 62%|██████▏   | 8/13 [04:47<03:00, 36.06s/it] 69%|██████▉   | 9/13 [05:24<02:24, 36.09s/it] 77%|███████▋  | 10/13 [05:59<01:47, 35.82s/it] 85%|████████▍ | 11/13 [06:35<01:11, 35.93s/it] 92%|█████████▏| 12/13 [07:09<00:35, 35.38s/it]100%|██████████| 13/13 [07:40<00:00, 34.09s/it]100%|██████████| 13/13 [07:40<00:00, 35.44s/it]
Testing payloads against WAF...
[+] Logging into DVWA...
  0%|          | 0/100 [00:00<?, ?it/s]  9%|▉         | 9/100 [00:00<00:01, 77.47it/s] 17%|█▋        | 17/100 [00:00<00:01, 75.18it/s] 30%|███       | 30/100 [00:00<00:00, 96.06it/s] 43%|████▎     | 43/100 [00:00<00:00, 108.66it/s] 56%|█████▌    | 56/100 [00:00<00:00, 113.01it/s] 70%|███████   | 70/100 [00:00<00:00, 119.28it/s] 84%|████████▍ | 84/100 [00:00<00:00, 124.35it/s] 97%|█████████▋| 97/100 [00:00<00:00, 122.08it/s]100%|██████████| 100/100 [00:00<00:00, 111.15it/s]
[2025-12-01 19:32:10] CMD="python scripts/evaluate_model.py --adapter experiments/phase2_phi3_mini_reasoning" STATUS=OK OUTPUT="eval_phase2_phi3.jsonl"

--- Summary ---
failed_waf_filter: 56 (56.00%)
blocked: 22 (22.00%)
reflected_no_exec: 19 (19.00%)
sql_error_bypass: 3 (3.00%)
Total Bypass: 3.00%
[12/01/2025 20:58:53] Starting Phase 3 Smoke Test
Loading model: google/gemma-2-2b-it + experiments/phase2_gemma2_2b_reasoning
`torch_dtype` is deprecated! Use `dtype` instead!
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:12<00:12, 12.99s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  5.78s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:13<00:00,  6.86s/it]

Starting Smoke Test (5 episodes)...

--- Episode 1 (SQLI) ---
Step 1: Reward=-0.1 | Status=failed_waf_filter
Step 2: Reward=-1.0 | Status=blocked
Step 3: Reward=-0.1 | Status=failed_waf_filter
Step 4: Reward=-0.1 | Status=failed_waf_filter
Step 5: Reward=-0.1 | Status=failed_waf_filter

--- Episode 2 (XSS) ---
Step 1: Reward=0.1 | Status=reflected_no_exec
Step 2: Reward=0.1 | Status=reflected_no_exec
Step 3: Reward=0.1 | Status=reflected_no_exec
Step 4: Reward=0.1 | Status=reflected_no_exec
Step 5: Reward=0.1 | Status=reflected_no_exec

--- Episode 3 (SQLI) ---
Step 1: Reward=-0.1 | Status=failed_waf_filter
Step 2: Reward=-0.1 | Status=failed_waf_filter
Step 3: Reward=-0.1 | Status=failed_waf_filter
Step 4: Reward=-0.1 | Status=failed_waf_filter
Step 5: Reward=-0.1 | Status=failed_waf_filter

--- Episode 4 (XSS) ---
Step 1: Reward=0.1 | Status=reflected_no_exec
Step 2: Reward=-1.0 | Status=blocked
Step 3: Reward=-1.0 | Status=blocked
Step 4: Reward=0.1 | Status=reflected_no_exec
Step 5: Reward=0.1 | Status=reflected_no_exec

--- Episode 5 (SQLI) ---
Step 1: Reward=-0.1 | Status=failed_waf_filter
Step 2: Reward=-0.1 | Status=failed_waf_filter
Step 3: Reward=-0.1 | Status=failed_waf_filter
Step 4: Reward=-0.1 | Status=failed_waf_filter
Step 5: Reward=-0.1 | Status=failed_waf_filter

Smoke test complete. Trajectories saved to rl/trajectories_phase3_smoke.jsonl
[12/01/2025 21:52:14] Starting RL REINFORCE Training
[12/01/2025 21:56:22] Starting RL REINFORCE Training (100 Episodes)
[12/02/2025 00:43:48] Starting Eval Gemma 2 Phase 3 RL
`torch_dtype` is deprecated! Use `dtype` instead!
Loading base model: google/gemma-2-2b-it
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:16<00:16, 16.68s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  7.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:17<00:00,  8.81s/it]
Loading adapter: experiments/phase3_gemma2_2b_rl
Generating payloads with batch size 32...
  0%|          | 0/4 [00:00<?, ?it/s]Asking to truncate to max_length but no maximum length is provided and the model has no predefined maximum length. Default to no truncation.
 25%|██▌       | 1/4 [01:07<03:21, 67.07s/it] 50%|█████     | 2/4 [02:08<02:07, 63.95s/it] 75%|███████▌  | 3/4 [03:11<01:03, 63.25s/it]100%|██████████| 4/4 [03:44<00:00, 51.54s/it]100%|██████████| 4/4 [03:44<00:00, 56.21s/it]
Testing payloads against WAF...
[+] Logging into DVWA...
  0%|          | 0/100 [00:00<?, ?it/s]  3%|▎         | 3/100 [00:00<00:03, 28.07it/s]  9%|▉         | 9/100 [00:00<00:01, 46.10it/s] 15%|█▌        | 15/100 [00:00<00:01, 52.29it/s] 23%|██▎       | 23/100 [00:00<00:01, 60.57it/s] 31%|███       | 31/100 [00:00<00:01, 66.37it/s] 39%|███▉      | 39/100 [00:00<00:00, 68.91it/s] 46%|████▌     | 46/100 [00:00<00:00, 66.20it/s] 55%|█████▌    | 55/100 [00:00<00:00, 70.93it/s] 64%|██████▍   | 64/100 [00:00<00:00, 74.22it/s] 73%|███████▎  | 73/100 [00:01<00:00, 76.44it/s] 83%|████████▎ | 83/100 [00:01<00:00, 81.66it/s] 92%|█████████▏| 92/100 [00:01<00:00, 80.91it/s]100%|██████████| 100/100 [00:01<00:00, 70.82it/s]
[2025-12-02 00:52:10] CMD="python scripts/evaluate_model.py --adapter experiments/phase3_gemma2_2b_rl" STATUS=OK OUTPUT="eval_phase3_gemma_rl.jsonl"

--- Summary ---
failed_waf_filter: 41 (41.00%)
passed: 30 (30.00%)
reflected_no_exec: 27 (27.00%)
blocked: 2 (2.00%)
Total Bypass: 30.00%
`torch_dtype` is deprecated! Use `dtype` instead!
Loading model: google/gemma-2-2b-it
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  6.40s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  7.60s/it]

--- Testing Target: dvwa ---
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:25<08:01, 25.33s/it] 10%|█         | 2/20 [00:47<06:58, 23.23s/it] 15%|█▌        | 3/20 [00:53<04:23, 15.50s/it] 20%|██        | 4/20 [01:16<04:56, 18.54s/it] 25%|██▌       | 5/20 [01:36<04:47, 19.16s/it] 30%|███       | 6/20 [01:42<03:24, 14.58s/it] 35%|███▌      | 7/20 [02:04<03:42, 17.08s/it] 40%|████      | 8/20 [02:07<02:30, 12.51s/it] 45%|████▌     | 9/20 [02:29<02:50, 15.52s/it] 50%|█████     | 10/20 [02:36<02:08, 12.87s/it] 55%|█████▌    | 11/20 [02:58<02:21, 15.70s/it] 60%|██████    | 12/20 [03:05<01:43, 12.93s/it] 65%|██████▌   | 13/20 [03:10<01:13, 10.46s/it] 70%|███████   | 14/20 [03:32<01:23, 13.94s/it] 75%|███████▌  | 15/20 [03:53<01:21, 16.27s/it] 80%|████████  | 16/20 [04:00<00:53, 13.31s/it] 85%|████████▌ | 17/20 [04:08<00:35, 11.75s/it] 90%|█████████ | 18/20 [04:24<00:26, 13.24s/it] 95%|█████████▌| 19/20 [04:31<00:11, 11.26s/it]100%|██████████| 20/20 [04:54<00:00, 14.78s/it]100%|██████████| 20/20 [04:54<00:00, 14.73s/it]
Results for dvwa: {
  "total": 20,
  "blocked": 1,
  "passed": 0,
  "reflected": 0,
  "error": 0,
  "failed_filter": 19
}

--- Testing Target: bwapp ---
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:22<07:02, 22.25s/it] 10%|█         | 2/20 [00:45<06:50, 22.79s/it] 15%|█▌        | 3/20 [00:53<04:36, 16.24s/it] 20%|██        | 4/20 [00:58<03:08, 11.81s/it] 25%|██▌       | 5/20 [01:16<03:26, 13.78s/it] 30%|███       | 6/20 [01:22<02:37, 11.27s/it] 35%|███▌      | 7/20 [01:44<03:13, 14.85s/it] 40%|████      | 8/20 [01:47<02:10, 10.89s/it] 45%|████▌     | 9/20 [02:09<02:40, 14.55s/it] 50%|█████     | 10/20 [02:14<01:55, 11.55s/it] 55%|█████▌    | 11/20 [02:29<01:51, 12.42s/it] 60%|██████    | 12/20 [02:31<01:15,  9.39s/it] 65%|██████▌   | 13/20 [02:35<00:53,  7.65s/it] 70%|███████   | 14/20 [02:57<01:13, 12.23s/it] 75%|███████▌  | 15/20 [03:05<00:53, 10.80s/it] 80%|████████  | 16/20 [03:15<00:42, 10.63s/it] 85%|████████▌ | 17/20 [03:23<00:29,  9.69s/it] 90%|█████████ | 18/20 [03:38<00:22, 11.39s/it] 95%|█████████▌| 19/20 [03:54<00:12, 12.83s/it]100%|██████████| 20/20 [04:19<00:00, 16.55s/it]100%|██████████| 20/20 [04:19<00:00, 13.00s/it]
Results for bwapp: {
  "total": 20,
  "blocked": 0,
  "passed": 0,
  "reflected": 0,
  "error": 0,
  "failed_filter": 20
}

--- Testing Target: juice_shop ---
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:16<05:19, 16.83s/it] 10%|█         | 2/20 [00:39<06:01, 20.09s/it] 15%|█▌        | 3/20 [00:45<03:50, 13.58s/it] 20%|██        | 4/20 [00:49<02:40, 10.05s/it] 25%|██▌       | 5/20 [01:04<02:56, 11.74s/it] 30%|███       | 6/20 [01:10<02:19,  9.95s/it] 35%|███▌      | 7/20 [01:32<03:00, 13.92s/it] 40%|████      | 8/20 [01:35<02:02, 10.23s/it] 45%|████▌     | 9/20 [01:43<01:45,  9.57s/it] 50%|█████     | 10/20 [01:49<01:23,  8.36s/it] 55%|█████▌    | 11/20 [02:11<01:54, 12.68s/it] 60%|██████    | 12/20 [02:33<02:03, 15.49s/it] 65%|██████▌   | 13/20 [02:34<01:18, 11.23s/it] 70%|███████   | 14/20 [02:57<01:27, 14.59s/it] 75%|███████▌  | 15/20 [03:20<01:25, 17.12s/it] 80%|████████  | 16/20 [03:31<01:01, 15.29s/it] 85%|████████▌ | 17/20 [03:35<00:36, 12.11s/it] 90%|█████████ | 18/20 [03:59<00:30, 15.50s/it] 95%|█████████▌| 19/20 [04:20<00:17, 17.32s/it]100%|██████████| 20/20 [04:42<00:00, 18.64s/it]100%|██████████| 20/20 [04:42<00:00, 14.13s/it]
Results for juice_shop: {
  "total": 20,
  "blocked": 0,
  "passed": 0,
  "reflected": 0,
  "error": 0,
  "failed_filter": 20
}

--- Testing Target: dvna ---
  0%|          | 0/20 [00:00<?, ?it/s] 60%|██████    | 12/20 [00:06<00:04,  1.92it/s] 75%|███████▌  | 15/20 [00:20<00:07,  1.60s/it] 80%|████████  | 16/20 [00:31<00:10,  2.73s/it] 85%|████████▌ | 17/20 [00:54<00:16,  5.42s/it] 95%|█████████▌| 19/20 [01:03<00:05,  5.23s/it]100%|██████████| 20/20 [01:03<00:00,  3.18s/it]
Results for dvna: {
  "total": 5,
  "blocked": 0,
  "passed": 0,
  "reflected": 0,
  "error": 0,
  "failed_filter": 5
}
=== Overall Summary ===
{
  "dvwa": {
    "total": 20,
    "blocked": 1,
    "passed": 0,
    "reflected": 0,
    "error": 0,
    "failed_filter": 19
  },
  "bwapp": {
    "total": 20,
    "blocked": 0,
    "passed": 0,
    "reflected": 0,
    "error": 0,
    "failed_filter": 20
  },
  "juice_shop": {
    "total": 20,
    "blocked": 0,
    "passed": 0,
    "reflected": 0,
    "error": 0,
    "failed_filter": 20
  },
  "dvna": {
    "total": 5,
    "blocked": 0,
    "passed": 0,
    "reflected": 0,
    "error": 0,
    "failed_filter": 5
  }
}
`torch_dtype` is deprecated! Use `dtype` instead!
Loading model: google/gemma-2-2b-it
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  6.43s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  7.63s/it]

=== Testing WAF: modsecurity_crs_p1 ===
--- App: dvwa ---
  0%|          | 0/20 [00:00<?, ?it/s]  5%|▌         | 1/20 [00:22<07:02, 22.26s/it]`torch_dtype` is deprecated! Use `dtype` instead!
Loading model: google/gemma-2-2b-it
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:14<00:14, 14.42s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  6.46s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:15<00:00,  7.65s/it]

--- Testing modsecurity_crs -> dvwa (SQLI) ---
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:23<08:16, 23.66s/it]  9%|▉         | 2/22 [00:46<07:38, 22.92s/it] 14%|█▎        | 3/22 [01:08<07:09, 22.58s/it] 18%|█▊        | 4/22 [01:17<05:12, 17.33s/it] 23%|██▎       | 5/22 [01:40<05:26, 19.20s/it] 27%|██▋       | 6/22 [01:46<04:00, 15.01s/it] 32%|███▏      | 7/22 [02:08<04:16, 17.10s/it] 36%|███▋      | 8/22 [02:10<02:54, 12.44s/it] 41%|████      | 9/22 [02:32<03:19, 15.36s/it] 45%|████▌     | 10/22 [02:36<02:21, 11.75s/it] 50%|█████     | 11/22 [02:57<02:41, 14.68s/it] 55%|█████▍    | 12/22 [03:04<02:02, 12.27s/it] 59%|█████▉    | 13/22 [03:25<02:15, 15.10s/it] 64%|██████▎   | 14/22 [03:41<02:02, 15.36s/it] 68%|██████▊   | 15/22 [04:04<02:01, 17.42s/it] 73%|███████▎  | 16/22 [04:25<01:52, 18.75s/it] 77%|███████▋  | 17/22 [04:41<01:28, 17.74s/it] 82%|████████▏ | 18/22 [04:49<00:59, 14.93s/it] 86%|████████▋ | 19/22 [04:54<00:35, 11.79s/it] 91%|█████████ | 20/22 [05:01<00:21, 10.53s/it] 95%|█████████▌| 21/22 [05:22<00:13, 13.71s/it]100%|██████████| 22/22 [05:26<00:00, 10.60s/it]100%|██████████| 22/22 [05:26<00:00, 14.83s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

--- Testing modsecurity_crs -> dvwa (XSS) ---
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:07<00:51,  7.41s/it] 25%|██▌       | 2/8 [00:22<01:10, 11.69s/it] 38%|███▊      | 3/8 [00:40<01:13, 14.75s/it] 50%|█████     | 4/8 [00:50<00:52, 13.03s/it] 62%|██████▎   | 5/8 [01:01<00:36, 12.22s/it] 75%|███████▌  | 6/8 [01:23<00:30, 15.40s/it] 88%|████████▊ | 7/8 [01:29<00:12, 12.31s/it]100%|██████████| 8/8 [01:50<00:00, 15.31s/it]100%|██████████| 8/8 [01:50<00:00, 13.86s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

--- Testing coraza_crs -> dvwa (SQLI) ---
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:19<06:41, 19.12s/it]  9%|▉         | 2/22 [00:40<06:54, 20.71s/it] 14%|█▎        | 3/22 [01:02<06:44, 21.28s/it] 18%|█▊        | 4/22 [01:20<05:59, 20.00s/it] 23%|██▎       | 5/22 [01:42<05:52, 20.72s/it] 27%|██▋       | 6/22 [01:49<04:13, 15.83s/it] 32%|███▏      | 7/22 [02:11<04:30, 18.02s/it] 36%|███▋      | 8/22 [02:14<03:03, 13.10s/it] 41%|████      | 9/22 [02:35<03:24, 15.69s/it] 45%|████▌     | 10/22 [02:41<02:30, 12.54s/it] 50%|█████     | 11/22 [03:02<02:47, 15.27s/it] 55%|█████▍    | 12/22 [03:09<02:06, 12.69s/it] 59%|█████▉    | 13/22 [03:31<02:18, 15.42s/it] 64%|██████▎   | 14/22 [03:46<02:03, 15.40s/it] 68%|██████▊   | 15/22 [04:07<02:00, 17.22s/it] 73%|███████▎  | 16/22 [04:29<01:51, 18.63s/it] 77%|███████▋  | 17/22 [04:51<01:37, 19.46s/it] 82%|████████▏ | 18/22 [04:58<01:02, 15.70s/it] 86%|████████▋ | 19/22 [05:05<00:39, 13.04s/it] 91%|█████████ | 20/22 [05:11<00:22, 11.21s/it] 95%|█████████▌| 21/22 [05:33<00:14, 14.39s/it]100%|██████████| 22/22 [05:37<00:00, 11.18s/it]100%|██████████| 22/22 [05:37<00:00, 15.34s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

--- Testing coraza_crs -> dvwa (XSS) ---
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:08<01:00,  8.63s/it] 25%|██▌       | 2/8 [00:17<00:54,  9.05s/it] 38%|███▊      | 3/8 [00:26<00:44,  8.87s/it] 50%|█████     | 4/8 [00:48<00:55, 13.85s/it] 62%|██████▎   | 5/8 [00:58<00:38, 12.67s/it] 75%|███████▌  | 6/8 [01:13<00:26, 13.30s/it] 88%|████████▊ | 7/8 [01:21<00:11, 11.65s/it]100%|██████████| 8/8 [01:29<00:00, 10.54s/it]100%|██████████| 8/8 [01:29<00:00, 11.20s/it]
Results: Blocked=1 (12.5%), Passed=0 (0.0%)

--- Testing coraza_crs -> juice_shop (XSS) ---
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:21<02:32, 21.84s/it] 25%|██▌       | 2/8 [00:36<01:47, 17.88s/it] 38%|███▊      | 3/8 [00:58<01:38, 19.74s/it] 50%|█████     | 4/8 [01:20<01:22, 20.66s/it] 62%|██████▎   | 5/8 [01:29<00:49, 16.40s/it] 75%|███████▌  | 6/8 [01:34<00:25, 12.54s/it] 88%|████████▊ | 7/8 [01:46<00:12, 12.18s/it]100%|██████████| 8/8 [01:56<00:00, 11.60s/it]100%|██████████| 8/8 [01:56<00:00, 14.58s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

=== Overall Comparison ===
WAF                  App        Attack     Blocked    Bypass     FullExec  
modsecurity_crs      dvwa       SQLI       0.0%       100.0%     0.0%      
modsecurity_crs      dvwa       XSS        0.0%       100.0%     0.0%      
coraza_crs           dvwa       SQLI       0.0%       100.0%     0.0%      
coraza_crs           dvwa       XSS        12.5%      87.5%      0.0%      
coraza_crs           juice_shop XSS        0.0%       100.0%     0.0%      
`torch_dtype` is deprecated! Use `dtype` instead!
Loading model: google/gemma-2-2b-it
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:13<00:13, 13.87s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  6.27s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  7.41s/it]

--- Testing modsecurity_crs -> dvwa (SQLI) ---
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:11<04:05, 11.69s/it]  9%|▉         | 2/22 [00:33<05:50, 17.54s/it] 14%|█▎        | 3/22 [00:38<03:44, 11.83s/it] 18%|█▊        | 4/22 [00:41<02:33,  8.53s/it] 23%|██▎       | 5/22 [01:01<03:30, 12.41s/it] 27%|██▋       | 6/22 [01:10<03:02, 11.38s/it] 32%|███▏      | 7/22 [01:32<03:42, 14.84s/it] 36%|███▋      | 8/22 [01:35<02:32, 10.92s/it] 41%|████      | 9/22 [01:56<03:04, 14.21s/it] 45%|████▌     | 10/22 [02:17<03:16, 16.39s/it] 50%|█████     | 11/22 [02:39<03:18, 18.05s/it] 55%|█████▍    | 12/22 [02:46<02:25, 14.55s/it] 59%|█████▉    | 13/22 [03:08<02:31, 16.85s/it] 64%|██████▎   | 14/22 [03:23<02:11, 16.42s/it] 68%|██████▊   | 15/22 [03:45<02:06, 18.08s/it] 73%|███████▎  | 16/22 [03:59<01:41, 16.86s/it] 77%|███████▋  | 17/22 [04:21<01:32, 18.50s/it] 82%|████████▏ | 18/22 [04:28<00:59, 14.80s/it] 86%|████████▋ | 19/22 [04:31<00:34, 11.40s/it] 91%|█████████ | 20/22 [04:38<00:20, 10.00s/it] 95%|█████████▌| 21/22 [04:53<00:11, 11.64s/it]100%|██████████| 22/22 [04:57<00:00,  9.40s/it]100%|██████████| 22/22 [04:57<00:00, 13.54s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

--- Testing modsecurity_crs -> dvwa (XSS) ---
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:10<01:15, 10.82s/it] 25%|██▌       | 2/8 [00:22<01:06, 11.07s/it] 38%|███▊      | 3/8 [00:43<01:20, 16.01s/it] 50%|█████     | 4/8 [00:52<00:51, 12.93s/it] 62%|██████▎   | 5/8 [00:59<00:32, 10.86s/it] 75%|███████▌  | 6/8 [01:05<00:18,  9.37s/it] 88%|████████▊ | 7/8 [01:22<00:11, 11.87s/it]100%|██████████| 8/8 [01:33<00:00, 11.43s/it]100%|██████████| 8/8 [01:33<00:00, 11.67s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

--- Testing coraza_crs -> dvwa (SQLI) ---
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:21<07:21, 21.01s/it]  9%|▉         | 2/22 [00:42<07:06, 21.35s/it] 14%|█▎        | 3/22 [00:48<04:33, 14.39s/it] 18%|█▊        | 4/22 [00:53<03:12, 10.71s/it] 23%|██▎       | 5/22 [01:16<04:13, 14.89s/it] 27%|██▋       | 6/22 [01:23<03:17, 12.33s/it] 32%|███▏      | 7/22 [01:45<03:51, 15.45s/it] 36%|███▋      | 8/22 [01:47<02:38, 11.30s/it] 41%|████      | 9/22 [01:52<02:02,  9.41s/it] 45%|████▌     | 10/22 [01:58<01:38,  8.21s/it] 50%|█████     | 11/22 [02:20<02:16, 12.39s/it] 55%|█████▍    | 12/22 [02:26<01:46, 10.62s/it] 59%|█████▉    | 13/22 [02:48<02:06, 14.03s/it] 64%|██████▎   | 14/22 [03:00<01:46, 13.32s/it] 68%|██████▊   | 15/22 [03:22<01:52, 16.06s/it] 73%|███████▎  | 16/22 [03:28<01:17, 12.90s/it] 77%|███████▋  | 17/22 [03:50<01:18, 15.67s/it] 82%|████████▏ | 18/22 [03:57<00:51, 12.93s/it] 86%|████████▋ | 19/22 [04:01<00:31, 10.43s/it] 91%|█████████ | 20/22 [04:06<00:17,  8.83s/it] 95%|█████████▌| 21/22 [04:27<00:12, 12.39s/it]100%|██████████| 22/22 [04:30<00:00,  9.62s/it]100%|██████████| 22/22 [04:30<00:00, 12.31s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

--- Testing coraza_crs -> dvwa (XSS) ---
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:22<02:34, 22.07s/it] 25%|██▌       | 2/8 [00:30<01:25, 14.20s/it] 38%|███▊      | 3/8 [00:36<00:51, 10.38s/it] 50%|█████     | 4/8 [00:58<01:00, 15.08s/it] 62%|██████▎   | 5/8 [01:09<00:40, 13.61s/it] 75%|███████▌  | 6/8 [01:26<00:28, 14.49s/it] 88%|████████▊ | 7/8 [01:35<00:12, 12.89s/it]100%|██████████| 8/8 [01:49<00:00, 13.14s/it]100%|██████████| 8/8 [01:49<00:00, 13.67s/it]
Results: Blocked=1 (12.5%), Passed=0 (0.0%)

--- Testing coraza_crs -> juice_shop (XSS) ---
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:11<01:23, 11.86s/it] 25%|██▌       | 2/8 [00:23<01:08, 11.46s/it] 38%|███▊      | 3/8 [00:38<01:05, 13.13s/it] 50%|█████     | 4/8 [00:47<00:46, 11.71s/it] 62%|██████▎   | 5/8 [00:59<00:34, 11.65s/it] 75%|███████▌  | 6/8 [01:08<00:21, 10.90s/it] 88%|████████▊ | 7/8 [01:30<00:14, 14.54s/it]100%|██████████| 8/8 [01:44<00:00, 14.18s/it]100%|██████████| 8/8 [01:44<00:00, 13.01s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

--- Testing modsecurity_pl4 -> dvwa (SQLI) ---
  0%|          | 0/22 [00:00<?, ?it/s]  5%|▍         | 1/22 [00:20<07:06, 20.32s/it]  9%|▉         | 2/22 [00:42<07:09, 21.50s/it] 14%|█▎        | 3/22 [00:52<05:04, 16.04s/it] 18%|█▊        | 4/22 [00:56<03:22, 11.27s/it] 23%|██▎       | 5/22 [01:15<04:03, 14.32s/it] 27%|██▋       | 6/22 [01:32<04:02, 15.14s/it] 32%|███▏      | 7/22 [01:54<04:21, 17.45s/it] 36%|███▋      | 8/22 [01:57<02:57, 12.66s/it] 41%|████      | 9/22 [02:18<03:20, 15.46s/it] 45%|████▌     | 10/22 [02:22<02:23, 11.94s/it] 50%|█████     | 11/22 [02:44<02:43, 14.88s/it] 55%|█████▍    | 12/22 [02:50<02:03, 12.30s/it] 59%|█████▉    | 13/22 [03:12<02:16, 15.13s/it] 64%|██████▎   | 14/22 [03:32<02:14, 16.76s/it] 68%|██████▊   | 15/22 [03:54<02:07, 18.26s/it] 73%|███████▎  | 16/22 [04:11<01:46, 17.81s/it] 77%|███████▋  | 17/22 [04:33<01:35, 19.12s/it] 82%|████████▏ | 18/22 [04:39<01:01, 15.25s/it] 86%|████████▋ | 19/22 [04:45<00:37, 12.36s/it] 91%|█████████ | 20/22 [04:57<00:24, 12.20s/it] 95%|█████████▌| 21/22 [05:17<00:14, 14.52s/it]100%|██████████| 22/22 [05:20<00:00, 11.21s/it]100%|██████████| 22/22 [05:20<00:00, 14.58s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

--- Testing modsecurity_pl4 -> dvwa (XSS) ---
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:08<00:56,  8.11s/it] 25%|██▌       | 2/8 [00:16<00:48,  8.09s/it] 38%|███▊      | 3/8 [00:36<01:09, 13.87s/it] 50%|█████     | 4/8 [00:42<00:42, 10.59s/it] 62%|██████▎   | 5/8 [00:53<00:32, 10.86s/it] 75%|███████▌  | 6/8 [00:59<00:17,  8.98s/it] 88%|████████▊ | 7/8 [01:19<00:12, 12.78s/it]100%|██████████| 8/8 [01:34<00:00, 13.35s/it]100%|██████████| 8/8 [01:34<00:00, 11.79s/it]
Results: Blocked=0 (0.0%), Passed=0 (0.0%)

=== Overall Comparison ===
WAF                  App        Attack     Blocked    Bypass     FullExec  
modsecurity_crs      dvwa       SQLI       0.0%       100.0%     0.0%      
modsecurity_crs      dvwa       XSS        0.0%       100.0%     0.0%      
coraza_crs           dvwa       SQLI       0.0%       100.0%     0.0%      
coraza_crs           dvwa       XSS        12.5%      87.5%      0.0%      
coraza_crs           juice_shop XSS        0.0%       100.0%     0.0%      
modsecurity_pl4      dvwa       SQLI       0.0%       100.0%     0.0%      
modsecurity_pl4      dvwa       XSS        0.0%       100.0%     0.0%      
[ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 8 : 2 6 ]   I N F O :   S t a r t i n g   P h a s e   1   B L U E   -   D a t a   P r e p  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 8 : 3 6 ]   I N F O :   S u r v e y i n g   R E D   l o g   f i l e s   f o r   B L U E   e p i s o d e   g e n e r a t i o n .  
 w s l   :   l s :   c a n n o t   a c c e s s   ' d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ m u l t i w a f _ * . j s o n l ' :   N o   s u c h   f i l e   o r    
 d i r e c t o r y  
 A t   l i n e : 1   c h a r : 1  
 +   w s l   l s   - 1   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e * . j s o n l   d a t a / a r c h i v e _ 2 0 2 5 1 1   . . .  
 +   ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~  
         +   C a t e g o r y I n f o                     :   N o t S p e c i f i e d :   ( l s :   c a n n o t   a c c e . . . l e   o r   d i r e c t o r y : S t r i n g )   [ ] ,   R e m o t e E x    
       c e p t i o n  
         +   F u l l y Q u a l i f i e d E r r o r I d   :   N a t i v e C o m m a n d E r r o r  
    
 d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 2 _ g e m m a . j s o n l  
 d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 2 _ p h i 3 . j s o n l  
 d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ g e m m a _ r l . j s o n l  
 r l / t r a j e c t o r i e s _ p h a s e 3 _ s m o k e . j s o n l  
 w s l   :   l s :   c a n n o t   a c c e s s   ' d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ m u l t i w a f _ c o r a z a _ c r s _ d v w a _ S Q L I . j s o n l ' :   N o    
 s u c h   f i l e   o r   d i r e c t o r y  
 A t   l i n e : 1   c h a r : 1  
 +   w s l   l s   - 1   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e * . j s o n l   d a t a / a r c h i v e _ 2 0 2 5 1 1   . . .  
 +   ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~  
         +   C a t e g o r y I n f o                     :   N o t S p e c i f i e d :   ( l s :   c a n n o t   a c c e . . . l e   o r   d i r e c t o r y : S t r i n g )   [ ] ,   R e m o t e E x    
       c e p t i o n  
         +   F u l l y Q u a l i f i e d E r r o r I d   :   N a t i v e C o m m a n d E r r o r  
    
 l s :   c a n n o t   a c c e s s   ' d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ m u l t i w a f _ c o r a z a _ c r s _ d v w a _ X S S . j s o n l ' :   N o   s u c h    
 f i l e   o r   d i r e c t o r y  
 l s :   c a n n o t   a c c e s s   ' d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ m u l t i w a f _ c o r a z a _ c r s _ j u i c e _ s h o p _ X S S . j s o n l ' :   N o    
 s u c h   f i l e   o r   d i r e c t o r y  
 l s :   c a n n o t   a c c e s s   ' d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ m u l t i w a f _ g e m m a 2 _ o v e r a l l _ c o m p a r i s o n . t x t ' :   N o    
 s u c h   f i l e   o r   d i r e c t o r y  
 d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 2 _ g e m m a . j s o n l  
 d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 2 _ p h i 3 . j s o n l  
 d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ g e m m a _ r l . j s o n l  
 r l / t r a j e c t o r i e s _ p h a s e 3 _ s m o k e . j s o n l  
 w s l   :   l s :   c a n n o t   a c c e s s   ' d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ m u l t i w a f _ * . j s o n l ' :   N o   s u c h   f i l e   o r    
 d i r e c t o r y  
 A t   l i n e : 1   c h a r : 1  
 +   w s l   l s   - 1   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ m u l t i w a f _ * . j s o n l   2 > & 1   |   t   . . .  
 +   ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~  
         +   C a t e g o r y I n f o                     :   N o t S p e c i f i e d :   ( l s :   c a n n o t   a c c e . . . l e   o r   d i r e c t o r y : S t r i n g )   [ ] ,   R e m o t e E x    
       c e p t i o n  
         +   F u l l y Q u a l i f i e d E r r o r I d   :   N a t i v e C o m m a n d E r r o r  
    
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 2 ]   I N F O :   T h e   f o l l o w i n g   R E D   l o g   f i l e s   w i l l   b e   u s e d   f o r   B L U E   e p i s o d e   c o n v e r s i o n :  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 2 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 2 _ g e m m a . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 2 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 2 _ p h i 3 . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / e v a l _ p h a s e 3 _ g e m m a _ r l . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   r l / t r a j e c t o r i e s _ p h a s e 3 _ s m o k e . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / p h a s e 3 _ m u l t i w a f _ c o r a z a _ c r s _ d v w a _ S Q L I . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / p h a s e 3 _ m u l t i w a f _ c o r a z a _ c r s _ d v w a _ X S S . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / p h a s e 3 _ m u l t i w a f _ c o r a z a _ c r s _ j u i c e _ s h o p _ X S S . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / p h a s e 3 _ m u l t i w a f _ m o d s e c u r i t y _ c r s _ d v w a _ S Q L I . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / p h a s e 3 _ m u l t i w a f _ m o d s e c u r i t y _ c r s _ d v w a _ X S S . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / p h a s e 3 _ m u l t i w a f _ m o d s e c u r i t y _ p l 4 _ d v w a _ S Q L I . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]       -   d a t a / a r c h i v e _ 2 0 2 5 1 1 2 9 / p h a s e 3 _ m u l t i w a f _ m o d s e c u r i t y _ p l 4 _ d v w a _ X S S . j s o n l  
 [ 1 2 / 0 2 / 2 0 2 5   0 9 : 0 9 : 4 3 ]   I N F O :   T h e s e   f i l e s   c o n t a i n   p a y l o a d ,   W A F   s t a t u s ,   a t t a c k   t y p e ,   a n d   s o m e t i m e s   a p p / W A F   d e t a i l s ,   s u i t a b l e   f o r   B L U E   e p i s o d e   c o n v e r s i o n .  
 Processing data/archive_20251129/eval_phase2_gemma.jsonl...
Traceback (most recent call last):
  File "/mnt/c/Users/HAD/Desktop/AI_in_cyber/LLM_in_Cyber/scripts/blue_build_phase1_episodes.py", line 272, in <module>
    main()
  File "/mnt/c/Users/HAD/Desktop/AI_in_cyber/LLM_in_Cyber/scripts/blue_build_phase1_episodes.py", line 228, in main
    for line in tqdm(f, desc=f"Converting {os.path.basename(filepath)}"):
NameError: name 'tqdm' is not defined
Processing data/archive_20251129/eval_phase2_gemma.jsonl...
Converting eval_phase2_gemma.jsonl: 0it [00:00, ?it/s]Converting eval_phase2_gemma.jsonl: 100it [00:00, 17413.14it/s]
Processing data/archive_20251129/eval_phase2_phi3.jsonl...
Converting eval_phase2_phi3.jsonl: 0it [00:00, ?it/s]Converting eval_phase2_phi3.jsonl: 100it [00:00, 33028.62it/s]
Processing data/archive_20251129/eval_phase3_gemma_rl.jsonl...
Converting eval_phase3_gemma_rl.jsonl: 0it [00:00, ?it/s]Converting eval_phase3_gemma_rl.jsonl: 100it [00:00, 17642.40it/s]
Processing rl/trajectories_phase3_smoke.jsonl...
Converting trajectories_phase3_smoke.jsonl: 0it [00:00, ?it/s]Converting trajectories_phase3_smoke.jsonl: 25it [00:00, 15945.50it/s]
Processing data/archive_20251129/phase3_multiwaf_coraza_crs_dvwa_SQLI.jsonl...
Converting phase3_multiwaf_coraza_crs_dvwa_SQLI.jsonl: 0it [00:00, ?it/s]Converting phase3_multiwaf_coraza_crs_dvwa_SQLI.jsonl: 22it [00:00, 7592.75it/s]
Processing data/archive_20251129/phase3_multiwaf_coraza_crs_dvwa_XSS.jsonl...
Converting phase3_multiwaf_coraza_crs_dvwa_XSS.jsonl: 0it [00:00, ?it/s]Converting phase3_multiwaf_coraza_crs_dvwa_XSS.jsonl: 8it [00:00, 6949.97it/s]
Processing data/archive_20251129/phase3_multiwaf_coraza_crs_juice_shop_XSS.jsonl...
Converting phase3_multiwaf_coraza_crs_juice_shop_XSS.jsonl: 0it [00:00, ?it/s]Converting phase3_multiwaf_coraza_crs_juice_shop_XSS.jsonl: 8it [00:00, 6808.94it/s]
Processing data/archive_20251129/phase3_multiwaf_modsecurity_crs_dvwa_SQLI.jsonl...
Converting phase3_multiwaf_modsecurity_crs_dvwa_SQLI.jsonl: 0it [00:00, ?it/s]Converting phase3_multiwaf_modsecurity_crs_dvwa_SQLI.jsonl: 22it [00:00, 17728.09it/s]
Processing data/archive_20251129/phase3_multiwaf_modsecurity_crs_dvwa_XSS.jsonl...
Converting phase3_multiwaf_modsecurity_crs_dvwa_XSS.jsonl: 0it [00:00, ?it/s]Converting phase3_multiwaf_modsecurity_crs_dvwa_XSS.jsonl: 8it [00:00, 7250.31it/s]
Processing data/archive_20251129/phase3_multiwaf_modsecurity_pl4_dvwa_SQLI.jsonl...
Converting phase3_multiwaf_modsecurity_pl4_dvwa_SQLI.jsonl: 0it [00:00, ?it/s]Converting phase3_multiwaf_modsecurity_pl4_dvwa_SQLI.jsonl: 22it [00:00, 17024.85it/s]
Processing data/archive_20251129/phase3_multiwaf_modsecurity_pl4_dvwa_XSS.jsonl...
Converting phase3_multiwaf_modsecurity_pl4_dvwa_XSS.jsonl: 0it [00:00, ?it/s]Converting phase3_multiwaf_modsecurity_pl4_dvwa_XSS.jsonl: 8it [00:00, 7131.65it/s]

--- BLUE Phase 1 Episodes Report ---
Total blue_episodes generated: 423

Vuln Effect Distribution:
- no-effect: 411
- xss-reflected: 8
- blocked_by_waf: 4

False Negative Distribution:
- False: 304
- True: 119

--- Example Blue Episode (first 1) ---
{
  "waf_env": {
    "engine": "modsecurity",
    "profile": "owasp_crs",
    "crs_version": "3.3.5",
    "paranoia_level": 1,
    "anomaly_threshold": 5,
    "extra_config": {}
  },
  "app_context": {
    "app_name": "dvwa",
    "endpoint": "",
    "http_method": "GET",
    "injection_point": "query_param",
    "tech_stack": "php_mysql"
  },
  "attack": {
    "attack_type": "UNKNOWN",
    "technique": "UNKNOWN",
    "payload": "ADMiN%2527%252509--<pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad><pad>",
    "red_model": "phi3_mini_phase3_rl",
    "phase": "phase2_sft",
    "timestamp": "2025-12-02T09:11:38.058995Z"
  },
  "waf_observation": {
    "blocked": false,
    "http_status": 200,
    "anomaly_score": null,
    "matched_rules": [],
    "raw_waf_log": null
  },
  "app_observation": {
    "http_status": 200,
    "resp_body_snippet": null,
    "error_class": null,
    "stack_trace_lang": null
  },
  "blue_label": {
    "vuln_effect": "no-effect",
    "is_false_negative": false,
    "expected_crs_rules": [],
    "severity": "low"
  }
}
[ 1 2 / 0 2 / 2 0 2 5   0 9 : 1 2 : 0 0 ]   I N F O :   N o   O W A S P   C R S   l o c a l   s o u r c e   d i r e c t o r y   f o u n d .   B L U E   P h a s e   1   K B   f o r   C R S   w i l l   b e   g e n e r a t e d   a s   a   s k e l e t o n   o r   w i t h   m a n u a l l y   b u i l t   s a m p l e   e n t r i e s .  
 Generated 2 CRS KB entries to data/blue/blue_phase1_crs_kb.jsonl

--- Example CRS KB Entry (first 1) ---
{
  "source": "crs_manual_sample",
  "rule_id": "956100",
  "test_description": "Detects Ruby error messages in response body.",
  "attack_type": [
    "info-leak",
    "error-disclosure"
  ],
  "variables": [
    "RESPONSE_BODY"
  ],
  "operator": "@rx (?i:\b(?:fatal|parse|syntax)\\s+(?:error|exception)|(?:in\\s+%s\\s+at\\s+line|on\\s+line)\\s+\\d+)",
  "message": "Remote Code Execution: Ruby error message detected.",
  "tags": [
    "attack-rce",
    "language-ruby"
  ],
  "paranoia_level": 1,
  "severity": "CRITICAL",
  "example_detection": {
    "resp_body_snippet": "SyntaxError (/path/to/your/app/controllers/reflects_controller.rb:10: ...)",
    "error_class": "Ruby::SyntaxError",
    "stack_trace_lang": "ruby"
  }
}
Loaded 423 blue_episodes.
Warning: No episodes found for effect 'sql-executed'. Skipping.
Warning: No episodes found for effect 'xss-executed'. Skipping.
Warning: No episodes found for effect 'sql-error-disclosure'. Skipping.
Warning: No episodes found for effect 'time-based-injection-potential'. Skipping.

--- BLUE Golden Set Report ---
Total golden_set episodes generated: 27
Traceback (most recent call last):
  File "/mnt/c/Users/HAD/Desktop/AI_in_cyber/LLM_in_Cyber/scripts/blue_build_golden_set.py", line 101, in <module>
    main()
  File "/mnt/c/Users/HAD/Desktop/AI_in_cyber/LLM_in_Cyber/scripts/blue_build_golden_set.py", line 91, in main
    vuln_effect_counts = Counter(e["blue_label"]["vuln_effect"] for e in golden_set)
NameError: name 'Counter' is not defined. Did you mean: 'count'?
Loaded 423 blue_episodes.
Warning: No episodes found for effect 'sql-executed'. Skipping.
Warning: No episodes found for effect 'xss-executed'. Skipping.
Warning: No episodes found for effect 'sql-error-disclosure'. Skipping.
Warning: No episodes found for effect 'time-based-injection-potential'. Skipping.

--- BLUE Golden Set Report ---
Total golden_set episodes generated: 39

Golden Set Vuln Effect Distribution:
- no-effect: 27
- xss-reflected: 8
- blocked_by_waf: 4

--- Example Golden Set Episode (first 1) ---
{
  "waf_env": {
    "engine": "modsecurity",
    "profile": "owasp_crs",
    "crs_version": "3.3.5",
    "paranoia_level": 1,
    "anomaly_threshold": 5,
    "extra_config": {}
  },
  "app_context": {
    "app_name": "dvwa",
    "endpoint": "",
    "http_method": "GET",
    "injection_point": "query_param",
    "tech_stack": "php_mysql"
  },
  "attack": {
    "attack_type": "SQLI",
    "technique": "UNKNOWN",
    "payload": "%2527%2520SELECT%2520version%2528%2529%2520--&A=C991&S=9E16&R=4691&D=1958",
    "red_model": "gemma2_2b_phase3_rl",
    "phase": "rl_smoke_test",
    "timestamp": "2025-12-02T09:11:38.167134Z"
  },
  "waf_observation": {
    "blocked": true,
    "http_status": 403,
    "anomaly_score": null,
    "matched_rules": [],
    "raw_waf_log": null
  },
  "app_observation": {
    "http_status": 200,
    "resp_body_snippet": null,
    "error_class": null,
    "stack_trace_lang": null
  },
  "blue_label": {
    "vuln_effect": "blocked_by_waf",
    "is_false_negative": false,
    "expected_crs_rules": [],
    "severity": "none"
  },
  "blue_recommendation": {
    "summary": "Attack successfully blocked by WAF. No action required.",
    "example_actions": []
  }
}
Loaded 39 golden set episodes.
Loaded 2 KB entries.
Traceback (most recent call last):
  File "/mnt/c/Users/HAD/Desktop/AI_in_cyber/LLM_in_Cyber/blue/runner_phase2_eval.py", line 143, in <module>
    main()
  File "/mnt/c/Users/HAD/Desktop/AI_in_cyber/LLM_in_Cyber/blue/runner_phase2_eval.py", line 84, in main
    retrieved_kb_entries = retrieve_for_episode(episode, kb, top_k=2)
  File "/mnt/c/Users/HAD/Desktop/AI_in_cyber/LLM_in_Cyber/blue/rag_retriever.py", line 36, in retrieve_for_episode
    return kb.query(query_text, top_k=top_k)
  File "/mnt/c/Users/HAD/Desktop/AI_in_cyber/LLM_in_Cyber/blue/rag_index.py", line 57, in query
    scores = defaultdict(int)
NameError: name 'defaultdict' is not defined
Loaded 39 golden set episodes.
Loaded 2 KB entries.

--- STUB LLM CALL ---
Prompt length: 2009 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2013 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 1994 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2190 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 1990 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 3116 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 1983 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 3189 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2086 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 3164 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2978 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 3084 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 1978 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 3050 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2220 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2191 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2774 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2197 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2083 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 3034 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2019 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2918 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2132 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2879 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2214 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2117 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2191 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2060 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 1973 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2101 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2014 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 1974 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 3055 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2019 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2194 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 1985 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2087 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 2066 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

--- STUB LLM CALL ---
Prompt length: 1983 characters.
Simulating LLM response...
--- END STUB LLM CALL ---

Raw evaluation results saved to data/blue/blue_phase2_eval_raw.jsonl

--- BLUE Phase 2 Evaluation Summary ---
Total golden set cases: 39
No golden set cases with 'expected_crs_rules' for rule hit evaluation.
Evaluation summary saved to data/blue/blue_phase2_eval_summary.txt
